<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CS357 软件验证 software | Yihui&#39;s docs</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <script language="javascript" type="text/JavaScript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script language="javascript" type="text/JavaScript" src="/js/MouseClickEffect.js"></script>
    <meta name="description" content="个人文档管理站点">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.4caa756d.css" as="style"><link rel="preload" href="/assets/js/app.862b4c32.js" as="script"><link rel="preload" href="/assets/js/3.9cc2b3a1.js" as="script"><link rel="preload" href="/assets/js/1.8c30e9e6.js" as="script"><link rel="preload" href="/assets/js/141.d3c21f17.js" as="script"><link rel="prefetch" href="/assets/js/10.89bf3c25.js"><link rel="prefetch" href="/assets/js/100.7133c3a8.js"><link rel="prefetch" href="/assets/js/101.932098af.js"><link rel="prefetch" href="/assets/js/102.c704e352.js"><link rel="prefetch" href="/assets/js/103.b291d6db.js"><link rel="prefetch" href="/assets/js/104.f0885496.js"><link rel="prefetch" href="/assets/js/105.b472b4cf.js"><link rel="prefetch" href="/assets/js/106.5449e0d1.js"><link rel="prefetch" href="/assets/js/107.712cb568.js"><link rel="prefetch" href="/assets/js/108.6bbb646f.js"><link rel="prefetch" href="/assets/js/109.23e9a01a.js"><link rel="prefetch" href="/assets/js/11.2c9469b3.js"><link rel="prefetch" href="/assets/js/110.5377dfc7.js"><link rel="prefetch" href="/assets/js/111.203e1bf9.js"><link rel="prefetch" href="/assets/js/112.515caa39.js"><link rel="prefetch" href="/assets/js/113.2211fb61.js"><link rel="prefetch" href="/assets/js/114.b078b81a.js"><link rel="prefetch" href="/assets/js/115.dda65b61.js"><link rel="prefetch" href="/assets/js/116.18f9570c.js"><link rel="prefetch" href="/assets/js/117.4542ab00.js"><link rel="prefetch" href="/assets/js/118.a8770ae0.js"><link rel="prefetch" href="/assets/js/119.d5e17064.js"><link rel="prefetch" href="/assets/js/12.a58abcfb.js"><link rel="prefetch" href="/assets/js/120.ec5a3762.js"><link rel="prefetch" href="/assets/js/121.1cbf0d1a.js"><link rel="prefetch" href="/assets/js/122.80d54e33.js"><link rel="prefetch" href="/assets/js/123.793b4d4f.js"><link rel="prefetch" href="/assets/js/124.0b9a9ddf.js"><link rel="prefetch" href="/assets/js/125.ec19248f.js"><link rel="prefetch" href="/assets/js/126.ea0acb20.js"><link rel="prefetch" href="/assets/js/127.31295f9c.js"><link rel="prefetch" href="/assets/js/128.da7ace80.js"><link rel="prefetch" href="/assets/js/129.a233f6d3.js"><link rel="prefetch" href="/assets/js/13.fa825284.js"><link rel="prefetch" href="/assets/js/130.9cb3b41f.js"><link rel="prefetch" href="/assets/js/131.ff462882.js"><link rel="prefetch" href="/assets/js/132.86e32433.js"><link rel="prefetch" href="/assets/js/133.54f255af.js"><link rel="prefetch" href="/assets/js/134.ef93a475.js"><link rel="prefetch" href="/assets/js/135.0cbdb5bc.js"><link rel="prefetch" href="/assets/js/136.87d608fc.js"><link rel="prefetch" href="/assets/js/137.433d1ac4.js"><link rel="prefetch" href="/assets/js/138.d2e8d969.js"><link rel="prefetch" href="/assets/js/139.da348669.js"><link rel="prefetch" href="/assets/js/14.6ef12044.js"><link rel="prefetch" href="/assets/js/140.7efcb7cf.js"><link rel="prefetch" href="/assets/js/142.e458f722.js"><link rel="prefetch" href="/assets/js/143.757b1062.js"><link rel="prefetch" href="/assets/js/144.b1e6765e.js"><link rel="prefetch" href="/assets/js/145.68ff0640.js"><link rel="prefetch" href="/assets/js/146.5ff49156.js"><link rel="prefetch" href="/assets/js/147.fd0e0707.js"><link rel="prefetch" href="/assets/js/148.5bd0032a.js"><link rel="prefetch" href="/assets/js/149.1a76c6aa.js"><link rel="prefetch" href="/assets/js/15.2272cff9.js"><link rel="prefetch" href="/assets/js/150.a4fc0fc4.js"><link rel="prefetch" href="/assets/js/151.955f72fc.js"><link rel="prefetch" href="/assets/js/152.85430891.js"><link rel="prefetch" href="/assets/js/153.624081d4.js"><link rel="prefetch" href="/assets/js/154.f67d47c5.js"><link rel="prefetch" href="/assets/js/155.754393a0.js"><link rel="prefetch" href="/assets/js/156.8f383304.js"><link rel="prefetch" href="/assets/js/157.af09cb0a.js"><link rel="prefetch" href="/assets/js/158.580049d3.js"><link rel="prefetch" href="/assets/js/159.d16a559a.js"><link rel="prefetch" href="/assets/js/16.1aa34173.js"><link rel="prefetch" href="/assets/js/160.d097207e.js"><link rel="prefetch" href="/assets/js/161.4558e711.js"><link rel="prefetch" href="/assets/js/162.595699fd.js"><link rel="prefetch" href="/assets/js/163.f4a3b7d0.js"><link rel="prefetch" href="/assets/js/164.bcabfd5b.js"><link rel="prefetch" href="/assets/js/165.e64f7329.js"><link rel="prefetch" href="/assets/js/166.14a65e28.js"><link rel="prefetch" href="/assets/js/167.98276fa6.js"><link rel="prefetch" href="/assets/js/168.6565520a.js"><link rel="prefetch" href="/assets/js/169.ff1cb633.js"><link rel="prefetch" href="/assets/js/17.05f4a788.js"><link rel="prefetch" href="/assets/js/170.11b56b2f.js"><link rel="prefetch" href="/assets/js/171.bafae7c9.js"><link rel="prefetch" href="/assets/js/18.c9d0a1d0.js"><link rel="prefetch" href="/assets/js/19.2b9b6042.js"><link rel="prefetch" href="/assets/js/20.06dd0149.js"><link rel="prefetch" href="/assets/js/21.e2fe4ea8.js"><link rel="prefetch" href="/assets/js/22.f8a4ee79.js"><link rel="prefetch" href="/assets/js/23.f19666dd.js"><link rel="prefetch" href="/assets/js/24.a6c97de3.js"><link rel="prefetch" href="/assets/js/25.eea82548.js"><link rel="prefetch" href="/assets/js/26.be6dc3ec.js"><link rel="prefetch" href="/assets/js/27.84cf2d4b.js"><link rel="prefetch" href="/assets/js/28.e762a6f9.js"><link rel="prefetch" href="/assets/js/29.7d4dfd03.js"><link rel="prefetch" href="/assets/js/30.566b3bbb.js"><link rel="prefetch" href="/assets/js/31.3ab87166.js"><link rel="prefetch" href="/assets/js/32.ff133fb1.js"><link rel="prefetch" href="/assets/js/33.78e5633c.js"><link rel="prefetch" href="/assets/js/34.7f49fcdc.js"><link rel="prefetch" href="/assets/js/35.3626c34f.js"><link rel="prefetch" href="/assets/js/36.19995ae2.js"><link rel="prefetch" href="/assets/js/37.2b94478b.js"><link rel="prefetch" href="/assets/js/38.3847345e.js"><link rel="prefetch" href="/assets/js/39.f3e8d2d0.js"><link rel="prefetch" href="/assets/js/4.a9e83867.js"><link rel="prefetch" href="/assets/js/40.82a78d99.js"><link rel="prefetch" href="/assets/js/41.3dafd3fe.js"><link rel="prefetch" href="/assets/js/42.5bedb0c9.js"><link rel="prefetch" href="/assets/js/43.a615e469.js"><link rel="prefetch" href="/assets/js/44.bcc6a268.js"><link rel="prefetch" href="/assets/js/45.f18225ca.js"><link rel="prefetch" href="/assets/js/46.250e5cc0.js"><link rel="prefetch" href="/assets/js/47.eaf57768.js"><link rel="prefetch" href="/assets/js/48.ba6cfb92.js"><link rel="prefetch" href="/assets/js/49.57b9c29e.js"><link rel="prefetch" href="/assets/js/5.8e4453e0.js"><link rel="prefetch" href="/assets/js/50.40246950.js"><link rel="prefetch" href="/assets/js/51.1a02dfb7.js"><link rel="prefetch" href="/assets/js/52.2eb4f3c8.js"><link rel="prefetch" href="/assets/js/53.2846ac65.js"><link rel="prefetch" href="/assets/js/54.78bbea29.js"><link rel="prefetch" href="/assets/js/55.850663af.js"><link rel="prefetch" href="/assets/js/56.fa4d919e.js"><link rel="prefetch" href="/assets/js/57.c7b452c8.js"><link rel="prefetch" href="/assets/js/58.28931fb3.js"><link rel="prefetch" href="/assets/js/59.ba2acaf6.js"><link rel="prefetch" href="/assets/js/6.b32243c4.js"><link rel="prefetch" href="/assets/js/60.27b531f5.js"><link rel="prefetch" href="/assets/js/61.6315a0f4.js"><link rel="prefetch" href="/assets/js/62.a596fd30.js"><link rel="prefetch" href="/assets/js/63.e016ce30.js"><link rel="prefetch" href="/assets/js/64.2aad2e3f.js"><link rel="prefetch" href="/assets/js/65.df31550d.js"><link rel="prefetch" href="/assets/js/66.ed006db8.js"><link rel="prefetch" href="/assets/js/67.7eff2ee5.js"><link rel="prefetch" href="/assets/js/68.15bb0456.js"><link rel="prefetch" href="/assets/js/69.b38a7e1a.js"><link rel="prefetch" href="/assets/js/7.b0ae972a.js"><link rel="prefetch" href="/assets/js/70.71ef19c6.js"><link rel="prefetch" href="/assets/js/71.2d8d5d0c.js"><link rel="prefetch" href="/assets/js/72.e2a809a4.js"><link rel="prefetch" href="/assets/js/73.b5c8670a.js"><link rel="prefetch" href="/assets/js/74.707ba4c2.js"><link rel="prefetch" href="/assets/js/75.2f0e00cf.js"><link rel="prefetch" href="/assets/js/76.19e67ef6.js"><link rel="prefetch" href="/assets/js/77.15e60094.js"><link rel="prefetch" href="/assets/js/78.d447cb84.js"><link rel="prefetch" href="/assets/js/79.2f8c4938.js"><link rel="prefetch" href="/assets/js/8.49100ceb.js"><link rel="prefetch" href="/assets/js/80.708f69aa.js"><link rel="prefetch" href="/assets/js/81.575f8ea1.js"><link rel="prefetch" href="/assets/js/82.4af889b0.js"><link rel="prefetch" href="/assets/js/83.c066688e.js"><link rel="prefetch" href="/assets/js/84.8091a558.js"><link rel="prefetch" href="/assets/js/85.72ceb3b6.js"><link rel="prefetch" href="/assets/js/86.dd2941f6.js"><link rel="prefetch" href="/assets/js/87.e3f0cf9c.js"><link rel="prefetch" href="/assets/js/88.11e4aad3.js"><link rel="prefetch" href="/assets/js/89.43c848f8.js"><link rel="prefetch" href="/assets/js/9.1f0c3c69.js"><link rel="prefetch" href="/assets/js/90.7b8ec81a.js"><link rel="prefetch" href="/assets/js/91.1da9382e.js"><link rel="prefetch" href="/assets/js/92.8314282f.js"><link rel="prefetch" href="/assets/js/93.7f024b5a.js"><link rel="prefetch" href="/assets/js/94.921593f6.js"><link rel="prefetch" href="/assets/js/95.e571cdb5.js"><link rel="prefetch" href="/assets/js/96.3731f8a1.js"><link rel="prefetch" href="/assets/js/97.f0b13686.js"><link rel="prefetch" href="/assets/js/98.5a683693.js"><link rel="prefetch" href="/assets/js/99.66be978a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4caa756d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1aefc0b4><div data-v-1aefc0b4><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1aefc0b4 data-v-1aefc0b4><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>Yihui's docs</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>个人文档管理站点</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <span data-v-25ba6db2>2021 - </span>
          2022
        </a></span></div></div> <div class="hide" data-v-1aefc0b4><header class="navbar" data-v-1aefc0b4><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://doc.yihuiblog.top/logo.png" alt="Yihui's docs" class="logo"> <span class="site-name">Yihui's docs</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/408/" class="nav-link"><i class="undefined"></i>
  408
</a></li><li class="dropdown-item"><!----> <a href="/categories/fontEnd/" class="nav-link"><i class="undefined"></i>
  fontEnd
</a></li><li class="dropdown-item"><!----> <a href="/categories/blog/" class="nav-link"><i class="undefined"></i>
  blog
</a></li><li class="dropdown-item"><!----> <a href="/categories/wiki/" class="nav-link"><i class="undefined"></i>
  wiki
</a></li><li class="dropdown-item"><!----> <a href="/categories/算法/" class="nav-link"><i class="undefined"></i>
  算法
</a></li><li class="dropdown-item"><!----> <a href="/categories/backend/" class="nav-link"><i class="undefined"></i>
  backend
</a></li><li class="dropdown-item"><!----> <a href="/categories/git/" class="nav-link"><i class="undefined"></i>
  git
</a></li><li class="dropdown-item"><!----> <a href="/categories/intern/" class="nav-link"><i class="undefined"></i>
  intern
</a></li><li class="dropdown-item"><!----> <a href="/categories/大学课程/" class="nav-link"><i class="undefined"></i>
  大学课程
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="https://github.com/MoMeak9" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/wiki/interview/" class="nav-link"><i class="undefined"></i>
  面试题汇总
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1aefc0b4></div> <aside class="sidebar" data-v-1aefc0b4><div class="personal-info-wrapper" data-v-39576ba9 data-v-1aefc0b4><img src="/logo.png" alt="author-avatar" class="personal-img" data-v-39576ba9> <!----> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>128</h3> <h6 data-v-39576ba9>Articles</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>17</h3> <h6 data-v-39576ba9>Tags</h6></div></div> <ul class="social-links" data-v-39576ba9><li class="social-item" data-v-39576ba9><i class="iconfont reco-github" style="color:#fb9b5f;" data-v-39576ba9></i></li><li class="social-item" data-v-39576ba9><i class="iconfont reco-npm" style="color:#f47e60;" data-v-39576ba9></i></li></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/408/" class="nav-link"><i class="undefined"></i>
  408
</a></li><li class="dropdown-item"><!----> <a href="/categories/fontEnd/" class="nav-link"><i class="undefined"></i>
  fontEnd
</a></li><li class="dropdown-item"><!----> <a href="/categories/blog/" class="nav-link"><i class="undefined"></i>
  blog
</a></li><li class="dropdown-item"><!----> <a href="/categories/wiki/" class="nav-link"><i class="undefined"></i>
  wiki
</a></li><li class="dropdown-item"><!----> <a href="/categories/算法/" class="nav-link"><i class="undefined"></i>
  算法
</a></li><li class="dropdown-item"><!----> <a href="/categories/backend/" class="nav-link"><i class="undefined"></i>
  backend
</a></li><li class="dropdown-item"><!----> <a href="/categories/git/" class="nav-link"><i class="undefined"></i>
  git
</a></li><li class="dropdown-item"><!----> <a href="/categories/intern/" class="nav-link"><i class="undefined"></i>
  intern
</a></li><li class="dropdown-item"><!----> <a href="/categories/大学课程/" class="nav-link"><i class="undefined"></i>
  大学课程
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="https://github.com/MoMeak9" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/wiki/interview/" class="nav-link"><i class="undefined"></i>
  面试题汇总
</a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>CS320 ComputerNetwork</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/university/CS320/Chapter1.html" class="sidebar-link">计算机网络Chapter1</a></li><li><a href="/university/CS320/Chapter2.html" class="sidebar-link">计算机网络Chapter2 Application Layer 应用层</a></li><li><a href="/university/CS320/Chapter3.html" class="sidebar-link">计算机网络Chapter3 Transport-layer  传输层</a></li><li><a href="/university/CS320/Chapter4.html" class="sidebar-link">计算机网络Chapter4 Network layer 网络层</a></li><li><a href="/university/CS320/Chapter5.html" class="sidebar-link">计算机网络Chapter5 Link Layer 链路层</a></li><li><a href="/university/CS320/Chapter6.html" class="sidebar-link">计算机网络Chapter6 无线网络与加密</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2></h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <span data-v-25ba6db2>2021 - </span>
          2022
        </a></span></div></div> <div data-v-1aefc0b4><main class="page"><section><div class="page-title"><h1 class="title">CS357 软件验证 software</h1> <div data-v-f875f3fc><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="cs357-软件验证-software"><a href="#cs357-软件验证-software" class="header-anchor">#</a> CS357 软件验证 software</h1> <h2 id="l2-design-by-contract-dbc"><a href="#l2-design-by-contract-dbc" class="header-anchor">#</a> L2 <strong>Design by Contract</strong> （DBC）</h2> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211220200309056.png" alt="image-20211220200309056" style="zoom:67%;"> <p>契约式设计/契约式编码（Design by Contract(DbC)/Programming by Contract，以下简称 DbC ）是一种设计计算机软件的方法。这种方法描述了，软件设计者应该为软件组件定义正式的、准确的、可验证的接口规范。</p> <p>Is a method of designing computer software. This approach describes how software designers should define formal, accurate, and verifiable interface specifications for software components.</p> <h3 id="key-concept"><a href="#key-concept" class="header-anchor">#</a> Key concept</h3> <p>**The supplier: ** Wrote the class code; documents it, maintains it; knows about the class  implementation; publishes the class interface.</p> <p><strong>The client:</strong>  Uses the class in their own code; reads the documentation (presumably);  knows about the class interface; knows nothing about the implementation.</p> <h3 id="main-principles"><a href="#main-principles" class="header-anchor">#</a> Main principles</h3> <ul><li>Every public method has a precondition and a postcondition.</li> <li>The precondition expresses the constraints under which the method will  function properly</li> <li>The postcondition expresses what will happen when a method executes  properly</li></ul> <h3 id="知识点"><a href="#知识点" class="header-anchor">#</a> 知识点：</h3> <p><strong>Non-redundancy principle 非冗余原理:</strong> The body of a method shall not check to see if the  precondition is true.</p> <p><strong>Precondition Availability Rule 可用性规则前提</strong>: Every feature appearing in the precondition of  a routine must be available to every client to which the routine is available</p> <p><strong>Inheritance:</strong></p> <p>Assume A is a superclass of B; then</p> <ul><li><p>B inherits all the (non-private) methods and instance variables from A.</p></li> <li><p>B might add more of these (extending the class), or change the  implementation of some methods (overriding the method)</p></li> <li><p>Therefore, a B-object must be able to do anything that an A-object can do;  i.e. it must be capable of behaving exactly like an A-object</p></li></ul> <h2 id="l3-4-logic-for-program-specification"><a href="#l3-4-logic-for-program-specification" class="header-anchor">#</a> L3&amp;4 Logic for Program  Specification</h2> <h2 id="l5-first-order-logic"><a href="#l5-first-order-logic" class="header-anchor">#</a> L5 First Order Logic</h2> <h4 id="predicate-logic-谓词逻辑"><a href="#predicate-logic-谓词逻辑" class="header-anchor">#</a> ⭐️Predicate logic 谓词逻辑</h4> <p>谓词逻辑是讨论事物和事物之间关系的逻辑的事情。</p> <p>Predicate logic is the logic for discussing things and relationships between things.</p> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211206210821371.png" alt="image-20211206210821371" style="zoom:67%;"> <p>有一阶逻辑，二阶逻辑，多类逻辑或无穷逻辑等等。</p> <p>There is first-order logic, second-order logic, multi-class logic or infinite logic, and so on.</p> <h4 id="propositional-logic-命题逻辑"><a href="#propositional-logic-命题逻辑" class="header-anchor">#</a> ⭐️Propositional logic 命题逻辑</h4> <p>在逻辑和数学里，命题演算（或称句子演算）是一个形式系统，有着可以由以逻辑运算符结合原子命题来构成代表“命题”的公式，以及允许某些公式建构成“定理”的一套形式“证明规则”。</p> <p>In logic and mathematics, propositional calculus (or sentence calculus) is a formal system with formulas representing &quot;propositions&quot; that can be formed by combining atomic propositions with logical operators, and a set of formal &quot;proof rules&quot; that allow certain formulas to form &quot;theorems&quot;.</p> <p><strong>二者关系：</strong> <strong>命题逻辑可以看作谓词逻辑的一个子集</strong>。Propositional logic can be regarded as a subset of predicate logic</p> <p><strong>是将命题逻辑表达不出来的逻辑继续细化</strong>，比如A（x,y）表示x喜欢y，则“小明喜欢数学”可以表示为A（小明，数学）</p> <p>Is to further refine the logic that cannot be expressed by propositional logic, for example, A (x,y) means x likes Y, then &quot;Xiaoming likes math&quot; can be expressed as A (Xiaoming, math).</p> <h3 id="常用逻辑"><a href="#常用逻辑" class="header-anchor">#</a> 常用逻辑</h3> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211206211246871.png" alt="image-20211206211246871" style="zoom:50%;"> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211206211257684.png" alt="image-20211206211257684" style="zoom:50%;"> <h2 id="l6-natural-deduction-proofs-自然演绎证明"><a href="#l6-natural-deduction-proofs-自然演绎证明" class="header-anchor">#</a> L6 ⭐️Natural Deduction Proofs (自然演绎证明</h2> <p>**Introduction：**If you have a goal of the form 𝑓𝑜𝑟𝑎𝑙𝑙 𝑥:𝐷, 𝑃 you just need to  do intro to introduce a new variable 𝑥: 𝐷 into the context.</p> <p>**Elimination：**If you have a hypothesis H of the form 𝑓𝑜𝑟𝑎𝑙𝑙 𝑥: 𝐷,𝑃, then pick  some current variable of type 𝐷, say 𝑣, and just use 𝑒𝑙𝑖𝑚 (𝐻 𝑣)消去</p> <h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211206214432688.png" alt="image-20211206214432688" style="zoom:50%;"> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211206214658165.png" alt="image-20211206214658165" style="zoom:50%;"> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211206214716387.png" alt="image-20211206214716387" style="zoom:50%;"> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211206214729407.png" alt="image-20211206214729407" style="zoom:50%;"> <h3 id="prasetree"><a href="#prasetree" class="header-anchor">#</a> PraseTree</h3> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211212182854888.png" alt="image-20211212182854888" style="zoom:10%;"> <h2 id="l8-9-formal-proof-in-logic-cnf-合取范式"><a href="#l8-9-formal-proof-in-logic-cnf-合取范式" class="header-anchor">#</a> L8&amp;9  ⭐️ Formal Proof in Logic &amp; CNF 合取范式</h2> <h3 id="models"><a href="#models" class="header-anchor">#</a> ⭐️Models</h3> <p><strong>Validity and satisfiability</strong></p> <p>A formula 𝜙 in propositional logic is</p> <ul><li><p><strong>satisfiable</strong> if it is true in some model <strong>可满足的</strong></p> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211220210802410.png" alt="image-20211220210802410" style="zoom:67%;"></li> <li><p><strong>valid</strong> if it is true in every model (it is a tautology) <strong>有效的</strong></p> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211220210815335.png" alt="image-20211220210815335" style="zoom:67%;"></li> <li><p><strong>unsatisfiable</strong> if it is false in every model <strong>不可满足的</strong></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211220210851646.png" alt="image-20211220210851646"></p></li></ul> <p>相反性 <strong>opposite</strong> ：</p> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211220211009350.png" alt="image-20211220211009350" style="zoom:67%;"> <h3 id="soundness-合理性"><a href="#soundness-合理性" class="header-anchor">#</a> ⭐️soundness 合理性</h3> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211220211232195.png" alt="image-20211220211232195"></p> <h3 id="completeness-完整性"><a href="#completeness-完整性" class="header-anchor">#</a> ⭐️completeness 完整性</h3> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211220211303807.png" alt="image-20211220211303807"></p> <h3 id="conjunctive-normal-form-cnf-translation"><a href="#conjunctive-normal-form-cnf-translation" class="header-anchor">#</a> ⭐️Conjunctive Normal Form (CNF) Translation</h3> <p>公式内，子式内只能为或/（并集），子式与子式之间为与/\（交集），子式可以是单个字母。</p> <p>规则：</p> <ol><li>箭头转换：</li></ol> <p>单箭头</p> <div class="language- extra-class"><pre class="language-text"><code>(𝑎 ∧ 𝑏) -&gt; c 至  ¬ (𝑎 ∧ 𝑏) ∨ c)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>（（p∨q）—&gt;r）—&gt;p 至 (┐(p∨q)∨r)—&gt;p 至 ┐(┐(p∨q)∨r)∨p
</code></pre></div><p>双箭头</p> <div class="language- extra-class"><pre class="language-text"><code>¬ a &lt;-&gt; x 同时满足双向箭头
¬ a &lt;- x 至 (¬ a \/ ¬x)     ¬a -&gt; x 至 a \/ x
¬ 𝑎 ∨ ¬𝑥 ∧ (𝑎 ∨ 𝑥)
</code></pre></div><ol start="2"><li>De Morgan's Law： 消去¬or 内移¬</li></ol> <div class="language- extra-class"><pre class="language-text"><code>¬(p ∨ q)&lt;=&gt;(¬p) ∧ (¬q)
¬(p ∧ q)&lt;=&gt;(¬p) ∨ (¬q)
</code></pre></div><h3 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example</h3> <ol><li></li></ol> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211212185340585.png" alt="image-20211212185340585"></p> <ol start="2"><li>注意对否单独取一双箭头转换</li></ol> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211212185620604.png" alt="image-20211212185620604" style="zoom:50%;"> <img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211212185648998.png" alt="image-20211212185648998" style="zoom:50%;"> <h2 id="l10-13-automated-reasoning"><a href="#l10-13-automated-reasoning" class="header-anchor">#</a> L10-13 <strong>AUTOMATED REASONING</strong></h2> <p>A formula where negation is applied only to propositional atoms is said to be in Negation Normal Form (NNF).</p> <p>A formula that is a multiary conjunction of muliary disjunctions of literals is in conjunctive normal form (CNF).</p> <p>A formula that is a multiary disjunction of multiary conjunctions of literals is in disjunctive normal form (DNF).</p> <h3 id="equisatisfiable-等可以满足的"><a href="#equisatisfiable-等可以满足的" class="header-anchor">#</a> ⭐️equisatisfiable 等可以满足的</h3> <p><strong>Given two formulas 𝑋 and 𝑌, we say they are equisatisfiable if and only if 𝑋 is satisfiable if and only if 𝑌 is.</strong></p> <p>If 𝑋 and 𝑌 are equisatisfiable, are they equivalent? :</p> <p><strong>No. 𝑋 and 𝑌 are equisatisfiable but they are not equal.Equisatisfiability is weaker than equivalence</strong></p> <h3 id="sat-boolean-satisfiability-problem"><a href="#sat-boolean-satisfiability-problem" class="header-anchor">#</a> ⭐️SAT Boolean satisfiability problem</h3> <p><strong>布尔可满足性问题</strong></p> <p><strong>是确定是否存在满足给定布尔公式的解释的问题。</strong> 换句话说，它询问给定布尔公式的变量是否可以一致地用值TRUE或FALSE替换，公式计算结果为TRUE。 如果是这种情况，公式称为可满足。</p> <p>Is the problem of determining whether there exists an interpretation that satisfies a given Boolean formula. In other words, it asks whether a variable given a Boolean formula can be consistently replaced with the value TRUE or FALSE, and the formula evaluates to TRUE. If this is the case, the formula is said to be satisfiable.</p> <h3 id="smt-satisfiability-modulo-theories"><a href="#smt-satisfiability-modulo-theories" class="header-anchor">#</a> ⭐️SMT satisfiability modulo theories</h3> <p><strong>可满足性模块理论</strong></p> <p>SMT问题的基础是一阶逻辑公式，在命题逻辑的基础上补充了项和量词，公式中的函数和谓词符号需要用对应的背景理论解释。<strong>通常情况下，SMT公式是无量词(quantifier free formula)的一阶逻辑公式，判定公式可满足性的问题称为SMT问题。</strong></p> <p>The SMT problem is based on the first-order logic formula, which is supplemented with terms and quantifiers on the basis of propositional logic. The function and predicate symbols in the formula need to be explained by the corresponding background theory. <strong>Generally, SMT formula is the first-order logical formula of quantifier free formula, and the problem of determining the satisfiability of formula is called SMT problem.</strong></p> <h4 id="main-difference-between-sat-solvers-and-smt-solvers"><a href="#main-difference-between-sat-solvers-and-smt-solvers" class="header-anchor">#</a> ⭐️Main difference between SAT solvers and SMT solvers</h4> <p>SAT solvers solve constraints involving(written in) propositional logic.</p> <p>SMT solvers can solve constraints involving propositional logic. Additionally it can solve constraints involving(written in) predicate logic with quantifiers. In simple words, SMT solvers are more powerful than SAT solvers.</p> <p>SAT 求解器解决涉及（写入）命题逻辑的约束。</p> <p>SMT 求解器可以求解涉及命题逻辑的约束。此外，它可以解决涉及（写入）带有量词的谓词逻辑的约束。简单来说，SMT 求解器比 SAT 求解器更强大。</p> <h2 id="l14-19hoare-logic-霍尔逻辑"><a href="#l14-19hoare-logic-霍尔逻辑" class="header-anchor">#</a> L14-19⭐️Hoare Logic 霍尔逻辑</h2> <h3 id="hoare-logic-examples"><a href="#hoare-logic-examples" class="header-anchor">#</a> <a href="https://moodle.maynoothuniversity.ie/pluginfile.php/881719/mod_resource/content/1/Lectures%2014%20-%2015%20-%20Notes%20-%20Hoare%20Logic%20Examples.pdf" target="_blank" rel="noopener noreferrer">Hoare Logic Examples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h4 id="算数表达式量词"><a href="#算数表达式量词" class="header-anchor">#</a> 算数表达式量词</h4> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211220200046631.png" alt="image-20211220200046631"></p> <h4 id="using-the-assign-rule-分配规则"><a href="#using-the-assign-rule-分配规则" class="header-anchor">#</a> Using the Assign Rule 分配规则</h4> <p>注意，如果我们不能证明给定的前提意味着(或等价于)在步骤2中计算的前提，那么程序就不能证明给定的前提和后置条件是正确的。</p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210336670.png" alt="image-20211216210336670"></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210424402.png" alt="image-20211216210424402"></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210436275.png" alt="image-20211216210436275"></p> <h4 id="using-the-composition-rule-合成规则"><a href="#using-the-composition-rule-合成规则" class="header-anchor">#</a> Using the composition rule 合成规则</h4> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210523885.png" alt="image-20211216210523885"></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210649120.png" alt="image-20211216210649120"></p> <h4 id="using-the-rule-for-if-statement-if语句规则"><a href="#using-the-rule-for-if-statement-if语句规则" class="header-anchor">#</a> Using the rule for if statement if语句规则</h4> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210729713.png" alt="image-20211216210729713"></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210804559.png" alt="image-20211216210804559"></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210813781.png" alt="image-20211216210813781"></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210825943.png" alt="image-20211216210825943"></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210849223.png" alt="image-20211216210849223"></p> <h4 id="综合练习"><a href="#综合练习" class="header-anchor">#</a> 综合练习</h4> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210908232.png" alt="image-20211216210908232"></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216210928624.png" alt="image-20211216210928624"></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216211006711.png" alt="image-20211216211006711"></p> <h3 id="hoare-logic-loop"><a href="#hoare-logic-loop" class="header-anchor">#</a> Hoare Logic Loop</h3> <p>Finding variant expressions for loop Termination（寻找循环终止变量）</p> <ol><li></li></ol> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216211442219.png" alt="image-20211216211442219"></p> <ol start="2"><li></li></ol> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211216211506720.png" alt="image-20211216211506720"></p> <h2 id="model-checking-temporal-logic-模型校验-时间逻辑"><a href="#model-checking-temporal-logic-模型校验-时间逻辑" class="header-anchor">#</a> ⭐️Model checking (temporal logic) 模型校验（时间逻辑）</h2> <h3 id="temporal-logic"><a href="#temporal-logic" class="header-anchor">#</a> temporal logic</h3> <p>使用存在量词或全称量词的任何逻辑都叫做一阶逻辑。把时间看作状态的序列的任何逻辑都是时间逻辑，只使用两个真值的任何逻辑都是二值逻辑。</p> <p>Any logic that uses existential or universal quantifiers is called first-order logic. Any logic that treats time as a sequence of states is temporal logic, and any logic that uses only two truth values is binary logic.</p> <p>在时间逻辑中，陈述可以有随时间变化的真值。与之相对的是非时间逻辑，它只能处理有着随时间恒定的真值的陈述。</p> <p>In temporal logic, statements can have truth values that vary over time.  In contrast, non-temporal logic can only deal with statements that have truth values constant over time.</p> <p>时序逻辑在形式验证中有着重要的应用，用于说明硬件或软件系统的需求。例如，人们可能想说，无论何时发出请求，最终都会授予对资源的访问权限，但绝不会同时授予两个请求者。这样的陈述可以方便地用时间逻辑来表达。</p> <p>The verification of these systems is done by providing a formal proof on an abstract mathematical model of the system, the correspondence between the mathematical model and the nature of the system being otherwise known by construction. Examples of mathematical objects often used to model systems are: finite state machines, labelled transition systems, Petri nets, vector addition systems, timed automata, hybrid automata, process algebra, formal semantics of programming languages such as operational semantics, denotational semantics, axiomatic semantics and Hoare logic.</p> <h2 id="dafny"><a href="#dafny" class="header-anchor">#</a> ⭐️Dafny</h2> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211223142441396.png" alt="image-20211223142441396"></p> <h4 id="程序-programms"><a href="#程序-programms" class="header-anchor">#</a> 程序 programms：</h4> <p>Dafny程序长这样：xxxxx.dfy，Dafny文件是以dfy结尾的。</p> <p>程序主要包含以下几部分：</p> <ol><li>类型(types)</li> <li>方法(methods)</li> <li>函数(functions)</li> <li>用户自定义的类型包括类（class）和归纳数据类型(inductive class)</li> <li>类class本身也包含一组声明(declarations)、介绍字段（introducing fields）、方法(methods)和函数(functions)。</li></ol> <p>如果有main方法那就从main开始验证程序，没有也没关系，main不是必须的。</p> <p>注释：// 双斜杠 或者 / <em>xxxxx</em> /</p> <p><strong>基本定义</strong></p> <p><strong>old(E)</strong> 表示E在方法入口时的值</p> <p>在类中，定义字段x为数据类型(types)T：</p> <p><strong>var x: T</strong></p> <p>注意事项：</p> <ul><li>数据类型必需手动申明的，不会被自动推断。</li> <li>通过在声明前加上关键 <strong>ghost</strong> 可以将该字段声明为幽灵（即用于规范<strong>而不是执行</strong>）字段。</li></ul> <p>Dafny 的9种数据类型包括：</p> <ul><li>bool：布尔值</li> <li>int：无界整数</li> <li>string: 字符串</li> <li>class/inductive class: 用户自定义的类和归纳类、</li> <li>set<T>：不可变的无序集合</T></li> <li>seq<T>：不可变的有序集合</T></li> <li>array<T>、array2<T>、array3<T>: 多维数组类型</T></T></T></li> <li>object：所有类型的超类</li> <li>nat：范围是int一半，非负整数。</li></ul> <h4 id="methods"><a href="#methods" class="header-anchor">#</a> Methods</h4> <p>Dafny 在许多方面类似于典型的命令式编程语言。有方法、变量、类型、循环、if 语句、数组、整数等等。任何 Dafny 程序的基本单元之一是方法。方法是一段命令式的、可执行的代码。在其他语言中，它们可能被称为过程或函数，但在 Dafny 中，术语“函数”是为一个不同的概念保留的，我们将在后面介绍。方法的声明方式如下：</p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">Abs</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span> returns <span class="token punctuation">(</span>y<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这声明了一个名为“Abs”的方法，它接受一个名为“x ”的整数参数，并返回一个名为“ y”的整数。请注意，每个参数和返回值都需要类型，并在冒号 ( :)后跟在每个名称之后。此外，返回值是命名的，并且可以有多个返回值，如下所示：</p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">MultipleReturns</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">,</span>y <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token function">returns</span><span class="token punctuation">(</span>more<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">,</span>less<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>方法体是包含在大括号内的代码，直到现在它被巧妙地表示为“ … ”（这不是Dafny 语法）。主体由一系列语句组成，例如熟悉的命令式赋值、if语句、循环、其他方法调用、返回语句等，例如方法可以实现为：</p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">MultipleReturns</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">,</span>y<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span> returns <span class="token punctuation">(</span>more<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">,</span>less<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	more <span class="token operator">:</span><span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
	less <span class="token operator">:</span><span class="token operator">=</span> x <span class="token operator">-</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>赋值使用“:=”而不是“=”，简单的语句后边跟着分号，空格和注释可以被忽略。</p> <p>返回值：</p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">Abs</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span> returns <span class="token punctuation">(</span>y<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> x <span class="token operator">&lt;</span> <span class="token number">0</span>
		<span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">-</span>x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">else</span>
		<span class="token punctuation">{</span> <span class="token keyword">return</span> x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>一个警告是他们总是需要在分支周围使用大括号，即使分支只包含一个语句（复合或其他）。</p> <h4 id="前置条件与后置条件-preconditions-and-postconditions"><a href="#前置条件与后置条件-preconditions-and-postconditions" class="header-anchor">#</a> 前置条件与后置条件 Preconditions and postconditions</h4> <h5 id="ensures-后置条件声明"><a href="#ensures-后置条件声明" class="header-anchor">#</a> ensures 后置条件声明</h5> <p>Dafny 的真正力量来自于对这些方法进行注释以指定其行为的能力。例如，我们观察到的一个属性Abs方法是无论输入如何，结果始终大于或等于零。有几种方法可以给出注解，但一些最常见和最基本的是方法前置 和后置条件。</p> <p>方法的这个属性Abs，即结果总是非负的，是后置条件的一个例子：<strong>它在方法返回后为真</strong>。<strong>使用ensures 关键字声明的后置条件作为方法声明的一部分在返回值（如果存在）之后和方法主体之前给出。</strong></p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">Abs</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>y<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
	ensures <span class="token number">0</span> <span class="token operator">&lt;=</span> y
<span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>你可以在这里看到为什么返回值被赋予名称。这使得它们很容易在方法的后置条件中引用。当表达式为真时，我们说后置条件成立。后置条件必须适用于函数的每次调用和每个可能的返回点（包括函数体末尾的隐式返回点）。在这种情况下，我们表达的唯一属性是返回值始终至少为零。</p> <p>有时，我们希望为我们的代码建立多个属性。在这种情况下，我们有两个选择。我们可以使用布尔值和运算符 ( )将这两个条件连接在一起，也可以编写多个规范。后者与前者基本相同，但性质不同。</p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">MultipleReturns</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span> returns <span class="token punctuation">(</span>more<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">,</span> less<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
   ensures less <span class="token operator">&lt;</span> x
   ensures x <span class="token operator">&lt;</span> more
<span class="token punctuation">{</span>
   more <span class="token operator">:</span><span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
   less <span class="token operator">:</span><span class="token operator">=</span> x <span class="token operator">-</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>后置条件也可以写成：</p> <div class="language- extra-class"><pre class="language-text"><code>ensures less &lt; x &amp;&amp; x &lt; more
</code></pre></div><p>甚至</p> <div class="language- extra-class"><pre class="language-text"><code>ensures less &lt; x &lt; more
</code></pre></div><p>Dafny 实际上拒绝了这个程序，声称第一个后置条件不成立（即不成立）。这意味着 Dafny 无法证明每次方法返回时此注释都成立。一般情况下，导致 Dafny 验证错误的主要原因有两个：与代码不一致的规范，以及它不够“聪明”以证明所需属性的情况。区分这两种可能性可能是一项艰巨的任务，但幸运的是，Dafny 和它所基于的 Boogie/Z3 系统非常聪明，并且将证明代码和规范相匹配而不会大惊小怪。</p> <p>在这种情况下，Dafny 说代码有错误是正确的。问题的关键是它y 是一个整数，所以它可以是负数。如果y为负（或零），则more 实际上可以小于或等于x。除非y严格大于零，否则我们的方法不会按预期工作。这恰恰是一个前提的想法。前置条件与后置条件类似，不同之处在于它之前必须为真 一个方法被调用。当你调用一个方法时，你的工作是建立（使）先决条件，Dafny 将使用证明来强制执行。同样，当您编写方法时，您可以假设前提条件，但必须建立后置条件。方法的调用者然后假设后置条件在方法返回后成立。</p> <h5 id="前置条件-requires"><a href="#前置条件-requires" class="header-anchor">#</a> 前置条件 requires</h5> <p><strong>先决条件有自己的关键字，requires</strong>。我们可以给出必要的前提条件MultipleReturns 如下：</p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">MultipleReturns</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span> returns <span class="token punctuation">(</span>more<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">,</span> less<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
   <span class="token keyword">requires</span> <span class="token number">0</span> <span class="token operator">&lt;</span> y
   ensures less <span class="token operator">&lt;</span> x <span class="token operator">&lt;</span> more
<span class="token punctuation">{</span>
   more <span class="token operator">:</span><span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
   less <span class="token operator">:</span><span class="token operator">=</span> x <span class="token operator">-</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="断言-assert"><a href="#断言-assert" class="header-anchor">#</a> 断言 assert</h4> <p>与前置条件和后置条件不同，断言放置在<strong>方法中间的某个位置</strong>。与前两个注释一样，断言有一个关键字assert，后跟布尔表达式和终止简单语句的分号。**断言说当控制到达代码的那部分时，特定的表达式总是成立。**例如，以下是在虚拟方法中简单使用断言：</p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">Testing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">assert</span> <span class="token number">2</span> <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Dafny 证明了这种方法是正确的，因为 2 总是小于 3。断言有多种用途，但其中最主要的是检查您对不同点的真实期望是否真的是真实的。您可以使用它来检查基本的算术事实，如上所述，但它们也可以用于更复杂的情况。断言是调试注释的强大工具，通过检查 Dafny 能够证明您的代码的内容。例如，我们可以使用它来调查 Dafny 对Abs函数的了解。</p> <h2 id="声明变量"><a href="#声明变量" class="header-anchor">#</a> 声明变量</h2> <div class="language- extra-class"><pre class="language-text"><code>var x: int := 5;
</code></pre></div><p>在这种情况下可以删除类型注释：(int省略)</p> <div class="language- extra-class"><pre class="language-text"><code>var x := 5;
</code></pre></div><p>可以一次声明多个变量：</p> <div class="language- extra-class"><pre class="language-text"><code>var x, y, z: bool := 1, 2, true;
</code></pre></div><p>显式类型声明仅适用于紧接在前面的变量，因此这里的bool声明仅适用于z，而不适用于x或y，它们都被推断为ints。我们需要变量是因为我们想讨论Abs 方法的返回值。我们不能Abs直接放入规范，因为该方法可能会改变内存状态等问题。所以我们捕获调用的返回值Abs如下：</p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">Testing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">var</span> v <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name">Abs</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">assert</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> v<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="函数-function"><a href="#函数-function" class="header-anchor">#</a> 函数 Function</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">abs</span><span class="token punctuation">(</span>x<span class="token operator">:</span> int<span class="token punctuation">)</span><span class="token operator">:</span> int
<span class="token punctuation">{</span>
<span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这声明了一个被调用的函数abs，它接收一个整数，并返回一个整数（第二个int），与在其主体中可以包含各种语句的方法不同，函数主体必须仅包含一个具有正确类型的表达式。这里我们的 body 必须是一个整数表达式。为了实现绝对值函数，我们需要使用if 表达式。if 表达式类似于其他语言中的三元运算符。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">abs</span><span class="token punctuation">(</span>x<span class="token operator">:</span> int<span class="token punctuation">)</span><span class="token operator">:</span> int
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> x <span class="token operator">&lt;</span> <span class="token number">0</span> then <span class="token operator">-</span>x <span class="token keyword">else</span> x
<span class="token punctuation">}</span>
</code></pre></div><p>那么为什么要用函数而不用方法呢，关键在于函数可以在规范中直接使用，所以我们可以我们可以这么写：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>assert <span class="token function">abs</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre></div><p>事实上，我们不仅可以直接编写这个语句而不捕获到局部变量，我们甚至不需要编写我们使用该方法所做的所有后置条件（尽管通常函数可以并且确实具有前置和后置条件）。功能的限制正是让 Dafny 做到这一点的原因。与方法不同，Dafny 在考虑其他函数时不会忘记函数体。所以它可以扩展上面断言中abs的定义，确定结果实际上是3。</p> <h2 id="循环不变量-invariant"><a href="#循环不变量-invariant" class="header-anchor">#</a> 循环不变量 invariant</h2> <p>虽然循环给 Dafny 带来了问题。Dafny 无法提前知道代码将在循环中运行多少次。但是 Dafny 需要考虑通过程序的所有路径，其中可能包括多次循环。为了让 Dafny 能够使用循环，您需要提供循环不变量，另一种注释。</p> <p>**循环不变量是在进入循环时以及在每次执行循环体之后保持不变的表达式。与前置条件和后置条件一样，不变量是为循环的每次执行保留的属性，使用我们见过的相同布尔表达式表示。**例如，我们在上面的循环中看到，如果i 开始为正值，则它保持正值。所以我们可以使用它自己的关键字将不变量添加到循环中：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">var</span> i <span class="token operator">:</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> i <span class="token operator">&lt;</span> n
  invariant <span class="token number">0</span> <span class="token operator">&lt;=</span> i
<span class="token punctuation">{</span>
  i <span class="token operator">:</span><span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当您指定一个不变量时，Dafny 证明了两件事：该不变量在进入循环时保持不变，并且由循环保留。保留，我们的意思是假设不变量在循环开始时成立，<strong>我们必须证明执行一次循环体会使不变量再次成立。</strong></p> <h4 id="终止-decreases减少"><a href="#终止-decreases减少" class="header-anchor">#</a> 终止 decreases减少</h4> <p>Dafny 通过使用decrease这个注释证明代码终止，即不会永远循环。对于很多事情，Dafny 能够猜出正确的注释，但有时需要明确说明。事实上，对于我们目前看到的所有代码，Dafny 已经能够自己做这个证明，这就是为什么我们还没有明确看到decrease注释的原因。Dafny 证明终止有两个地方：循环和递归。这两种情况都需要明确的注释或 Dafny 的正确猜测。</p> <p>顾名思义，递减注释给出了随着每次循环迭代或递归调用而递减的 Dafny 和表达式。**Dafny 在使用递减表达式时需要验证两个条件：表达式实际上变小了，并且它是有界的。**很多时候，整数值（自然或普通整数）是减少的数量，但也可以使用其他东西。（有关详细信息，请参阅参考资料。）对于整数，假定界限为零。例如，以下是循环中减少的正确使用（当然有自己的关键字）：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">while</span> <span class="token number">0</span> <span class="token operator">&lt;</span> i
invariant <span class="token number">0</span> <span class="token operator">&lt;=</span> i
decreases i
<span class="token punctuation">{</span>
  i <span class="token operator">:</span><span class="token operator">=</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在这里，Dafny 拥有证明终止所需的所有要素。i每次循环迭代该变量都会变小，并且下限为零。这很好，除了循环是从大多数循环向后计数的，这些循环倾向于向上计数而不是向下计数。在这种情况下，减少的不是计数器本身，而是计数器与上限之间的距离。下面给出了处理这种情况的简单技巧：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">while</span> i <span class="token operator">&lt;</span> n
  invariant <span class="token number">0</span> <span class="token operator">&lt;=</span> i <span class="token operator">&lt;=</span> n
  decreases n <span class="token operator">-</span> i
<span class="token punctuation">{</span>
  i <span class="token operator">:</span><span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这实际上是 Dafny 对这种情况的猜测，因为它看到并假设n-i是减少的数量。</p> <h4 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h4> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211223145413933.png" alt="image-20211223145413933" style="zoom:50%;"><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211223145401064.png" alt="image-20211223145401064" style="zoom:50%;"></p> <p><strong>如果一个方法改变了作为参数的数组元素，那么它的规范必须包括modify a</strong></p> <p><img src="https://mc-web-1259409954.cos.ap-guangzhou.myqcloud.com/MyImages/image-20211223151549175.png" alt="image-20211223151549175"></p> <p>我们可能想要对数组做的最基本的事情之一是搜索它以查找特定的键，并返回我们可以找到键的位置的索引（如果它存在）。<strong>我们有两个搜索结果，每个结果都有不同的正确性条件。如果算法返回一个索引（即非负整数），那么该键应该出现在该索引处</strong>。这可以表示如下：</p> <p>==&gt; 左满足则右理应满足</p> <div class="language-ts extra-class"><pre class="language-ts"><code>method <span class="token function">Find</span><span class="token punctuation">(</span>a<span class="token operator">:</span> array<span class="token operator">&lt;</span>int<span class="token operator">&gt;</span><span class="token punctuation">,</span> key<span class="token operator">:</span> int<span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span>index<span class="token operator">:</span> int<span class="token punctuation">)</span>
ensures <span class="token number">0</span> <span class="token operator">&lt;=</span> index <span class="token operator">==</span><span class="token operator">&gt;</span> index <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>Length <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> key
<span class="token punctuation">{</span>
  <span class="token comment">// Open in editor for a challenge...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里的数组索引是安全的，因为蕴涵运算符是短路的。短路是指如果左边的部分为假，那么不管第二部分的真值如何，蕴涵都已经为真，因此不需要对其进行评估。</p> <h5 id="序列运算"><a href="#序列运算" class="header-anchor">#</a> <strong>序列运算</strong></h5> <p>对序列的操作包括 +（连接）和比较运算符 &lt;（适当的前缀）和 &lt;=（前缀）。成员资格可以像集合一样检查：x in S 和 x !in S。序列 S 的长度表示为 |S|，并且此类序列的元素具有从 0 到小于 |S| 的索引。表达式 S[j] 表示序列 S 的索引 j 处的元素。<strong>表达式 S[m..n]，其中 0 &lt;= m &lt;= n &lt;= |S|，返回一个序列，其元素是S 从索引 m 开始（即，从 S[m]、S[m+1]、……直到但不包括 S[n]）</strong>。表达式 S[m..]; （通常称为“drop m”）与 S[m..|S|] 相同；也就是说，它<strong>返回除 S 的前 m 个元素之外的所有元素的序列</strong>。表达式 S[..n] ; （通常称为“take n”）与 S[0..n] 相同，即它返回由 S 的前 n 个元素组成的序列。</p> <h4 id="量词-forall"><a href="#量词-forall" class="header-anchor">#</a> 量词 forall</h4> <p>Dafny 中的量词通常采用forall表达式的形式，也称为全称量词。顾名思义，<strong>如果某个属性对某个集合的所有元素都成立，则该表达式为真</strong>。现在，我们将考虑整数集。下面给出了一个包含在断言中的全称量词示例：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>assert forall k <span class="token operator">:</span><span class="token operator">:</span> k <span class="token operator">&lt;</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>量词为其考虑的集合中的每个元素引入一个临时名称。在这种情况下，这称为绑定变量k。绑定变量有一个类型，它几乎总是被推断而不是显式给出，并且通常是int无论如何。<strong>一对冒号(::)将绑定变量及其可选类型与量化属性(必须是bool类型)分隔开来</strong>。通常，量化无限集（例如所有整数）并不是很有用。相反，量词通常用于量化数组或数据结构中的所有元素。我们通过使用蕴涵运算符对数组执行此操作，使量化属性对于不是索引的值非常正确。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>assert forall k <span class="token operator">:</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> k <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>Length <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token operator">...</span>a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">...</span><span class="token punctuation">;</span>
</code></pre></div><p>这表示数组的每个元素都有一些属性。这意味着k在评估表达式的第二部分之前确保它实际上是数组中的有效索引。Dafny 不仅可以使用这个事实来证明数组是安全访问的，而且还可以将它必须考虑的整数集减少到仅作为数组索引的整数集。</p> <p>使用量词，说键不在数组中很简单：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>forall k <span class="token operator">:</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> k <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>Length <span class="token operator">==</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> key
</code></pre></div><p>因此，我们的方法后置条件变为：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>method <span class="token function">Find</span><span class="token punctuation">(</span>a<span class="token operator">:</span> array<span class="token operator">&lt;</span>int<span class="token operator">&gt;</span><span class="token punctuation">,</span> key<span class="token operator">:</span> int<span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span>index<span class="token operator">:</span> int<span class="token punctuation">)</span>
ensures <span class="token number">0</span> <span class="token operator">&lt;=</span> index <span class="token operator">==</span><span class="token operator">&gt;</span> index <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>Length <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> key
ensures index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">==</span><span class="token operator">&gt;</span> forall k <span class="token operator">:</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> k <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>Length <span class="token operator">==</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> key
<span class="token punctuation">{</span>
<span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们可以通过多种方式填充此方法的主体，但也许最简单的是线性搜索，实现如下：</p> <div class="language-java extra-class"><pre class="language-java"><code>index <span class="token operator">:</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span> index <span class="token operator">&lt;</span> <span class="token class-name"><span class="token namespace">a<span class="token punctuation">.</span></span>Length</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">if</span> a<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> key <span class="token punctuation">{</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      index <span class="token operator">:</span><span class="token operator">=</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   index <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>如您所见，我们在 while 循环中省略了循环不变量，因此 Dafny 在其中一个后置条件上给了我们一个验证错误。我们得到错误的原因是 Dafny 不知道循环实际上涵盖了所有元素。为了让 Dafny 相信这一点，我们必须编写一个不变量，说明当前索引之前的所有内容都已被查看（并且不是键）。就像后置条件一样，我们可以使用量词来表达这个属性：</p> <div class="language-java extra-class"><pre class="language-java"><code>invariant forall k <span class="token operator">::</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> k <span class="token operator">&lt;</span> index <span class="token operator">==</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> key
</code></pre></div><p>最终代码：</p> <div class="language-java extra-class"><pre class="language-java"><code>method <span class="token class-name">Find</span><span class="token punctuation">(</span>a<span class="token operator">:</span> array<span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span> returns <span class="token punctuation">(</span>index<span class="token operator">:</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
   ensures <span class="token number">0</span> <span class="token operator">&lt;=</span> index <span class="token operator">==</span><span class="token operator">&gt;</span> index <span class="token operator">&lt;</span> <span class="token class-name"><span class="token namespace">a<span class="token punctuation">.</span></span>Length</span> <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> key
   ensures index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">==</span><span class="token operator">&gt;</span> forall k <span class="token operator">::</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> k <span class="token operator">&lt;</span> <span class="token class-name"><span class="token namespace">a<span class="token punctuation">.</span></span>Length</span> <span class="token operator">==</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> key
<span class="token punctuation">{</span>
   index <span class="token operator">:</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span> index <span class="token operator">&lt;</span> <span class="token class-name"><span class="token namespace">a<span class="token punctuation">.</span></span>Length</span>
      invariant <span class="token number">0</span> <span class="token operator">&lt;=</span> index <span class="token operator">&lt;=</span> <span class="token class-name"><span class="token namespace">a<span class="token punctuation">.</span></span>Length</span>
      invariant forall k <span class="token operator">::</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> k <span class="token operator">&lt;</span> index <span class="token operator">==</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> key
   <span class="token punctuation">{</span>
      <span class="token keyword">if</span> a<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> key <span class="token punctuation">{</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      index <span class="token operator">:</span><span class="token operator">=</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   index <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="class-类"><a href="#class-类" class="header-anchor">#</a> Class 类</h4> <p>一个类定义如下：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">ChecksumMachine</span> <span class="token punctuation">{</span> 
	<span class="token keyword">var</span> data<span class="token operator">:</span> <span class="token builtin">string</span> 
	<span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 匿名构造函数</span>
		ensures data <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> 
	method <span class="token function">Append</span><span class="token punctuation">(</span>d<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> 
		modifes <span class="token keyword">this</span> 
		ensures data <span class="token operator">==</span> <span class="token function">old</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> d 
	functon method <span class="token function">Checksum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> int 
		reads <span class="token keyword">this</span> 
		ensures <span class="token function">Checksum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">Hash</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
method <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
	<span class="token keyword">var</span> m <span class="token operator">:</span><span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChecksumMachine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token string">&quot;green&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token string">&quot;grass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">var</span> c <span class="token operator">:</span><span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">Checksum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	print <span class="token string">&quot;Checksum is &quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre></div><p>其中类的成员（字段、方法和函数）在花括号内定义（如上所述）。</p> <h3 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h3> <p>斐波那契</p> <div class="language-java extra-class"><pre class="language-java"><code>function <span class="token class-name">Fib</span><span class="token punctuation">(</span>n<span class="token operator">:</span> nat<span class="token punctuation">)</span><span class="token operator">:</span> nat 
decreases n
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">2</span> then n <span class="token keyword">else</span> <span class="token class-name">Fib</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">Fib</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
</code></pre></div><p>最大最小值鉴定</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">max</span><span class="token punctuation">(</span>a<span class="token operator">:</span> int<span class="token punctuation">,</span> b<span class="token operator">:</span> int<span class="token punctuation">)</span><span class="token operator">:</span> int
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> a <span class="token operator">&gt;</span> b then a <span class="token keyword">else</span> b
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">min</span><span class="token punctuation">(</span>a<span class="token operator">:</span> int<span class="token punctuation">,</span> b<span class="token operator">:</span> int<span class="token punctuation">)</span><span class="token operator">:</span> int
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> a <span class="token operator">&lt;</span> b then a <span class="token keyword">else</span> b
<span class="token punctuation">}</span>

method <span class="token function">Max</span><span class="token punctuation">(</span>x<span class="token operator">:</span> int<span class="token punctuation">,</span> y<span class="token operator">:</span> int<span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span>m<span class="token operator">:</span> int<span class="token punctuation">)</span>
requires <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">// ensures (m==x||m==y)&amp;&amp;x&lt;=m&amp;&amp;y&lt;=m</span>
ensures m <span class="token operator">==</span> <span class="token function">max</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
  assert <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> x <span class="token operator">&lt;=</span> y
  <span class="token punctuation">{</span>
    m<span class="token operator">:</span><span class="token operator">=</span>y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
    m<span class="token operator">:</span><span class="token operator">=</span>x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

method <span class="token function">Min</span><span class="token punctuation">(</span>x<span class="token operator">:</span> int<span class="token punctuation">,</span> y<span class="token operator">:</span> int<span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span>m<span class="token operator">:</span> int<span class="token punctuation">)</span>
requires <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">// ensures (m==x||m==y)&amp;&amp;x&gt;=m&amp;&amp;y&gt;=m</span>
ensures m <span class="token operator">==</span> <span class="token function">min</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&lt;=</span>y<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    m<span class="token operator">:</span><span class="token operator">=</span>x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
    m<span class="token operator">:</span><span class="token operator">=</span>y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2^n 计算 与 a^n 次方</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">pow2</span><span class="token punctuation">(</span>n<span class="token operator">:</span>nat<span class="token punctuation">)</span><span class="token operator">:</span>nat
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span> then <span class="token number">1</span>
<span class="token keyword">else</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">pow2</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">pow2v2</span><span class="token punctuation">(</span>a<span class="token operator">:</span>int<span class="token punctuation">,</span>n<span class="token operator">:</span>nat<span class="token punctuation">)</span><span class="token operator">:</span>int
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span> then <span class="token number">1</span>
<span class="token keyword">else</span> a<span class="token operator">*</span><span class="token function">pow2v2</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>校验方法  a^n 次方</p> <div class="language-ts extra-class"><pre class="language-ts"><code>method <span class="token function">Pow</span><span class="token punctuation">(</span>a<span class="token operator">:</span>int<span class="token punctuation">,</span>n<span class="token operator">:</span>nat<span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span>result<span class="token operator">:</span>int<span class="token punctuation">)</span>
ensures result <span class="token operator">==</span> <span class="token function">pow2v2</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  result <span class="token operator">:</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> i<span class="token operator">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> i <span class="token operator">&lt;</span> n
    invariant <span class="token number">0</span> <span class="token operator">&lt;=</span> i <span class="token operator">&lt;=</span>n
  invariant result <span class="token operator">==</span> <span class="token function">pow2v2</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    result <span class="token operator">:</span><span class="token operator">=</span> result<span class="token operator">*</span>a<span class="token punctuation">;</span>
    i<span class="token operator">:</span><span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>正整数前n项和</p> <div class="language-ts extra-class"><pre class="language-ts"><code>method <span class="token function">SumFirst</span><span class="token punctuation">(</span>n<span class="token operator">:</span>nat<span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span>sum<span class="token operator">:</span>nat<span class="token punctuation">)</span>
ensures sum <span class="token operator">==</span> n<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
<span class="token punctuation">{</span>
  <span class="token keyword">var</span> i<span class="token operator">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  sum <span class="token operator">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">)</span>
    invariant i<span class="token operator">&lt;=</span>n
  invariant sum <span class="token operator">==</span> i<span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
  <span class="token punctuation">{</span>
    i <span class="token operator">:</span><span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    sum <span class="token operator">:</span><span class="token operator">=</span> sum <span class="token operator">+</span> i<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>斐波那契递归校验和迭代计算</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">Fib</span><span class="token punctuation">(</span>n<span class="token operator">:</span>nat<span class="token punctuation">)</span><span class="token operator">:</span>nat
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> then n
<span class="token keyword">else</span> <span class="token function">Fib</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Fib</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

method <span class="token function">FibIter</span><span class="token punctuation">(</span>n<span class="token operator">:</span>nat<span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span>x<span class="token operator">:</span>nat<span class="token punctuation">)</span>
ensures x <span class="token operator">==</span> <span class="token function">Fib</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span> i<span class="token operator">:</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> a<span class="token operator">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  x<span class="token operator">:</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">)</span>
    invariant <span class="token number">0</span><span class="token operator">&lt;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>
  invariant a<span class="token operator">==</span><span class="token function">Fib</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  invariant x<span class="token operator">==</span><span class="token function">Fib</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  decreases n<span class="token operator">-</span>i
  <span class="token punctuation">{</span>
    a<span class="token punctuation">,</span>x <span class="token operator">:</span><span class="token operator">=</span> x<span class="token punctuation">,</span>a<span class="token operator">+</span>x<span class="token punctuation">;</span>
    i<span class="token operator">:</span><span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>线性搜索最小值</p> <div class="language-ts extra-class"><pre class="language-ts"><code>method <span class="token function">Smallest</span><span class="token punctuation">(</span>a<span class="token operator">:</span> array<span class="token operator">&lt;</span>int<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span>minIndex<span class="token operator">:</span> nat<span class="token punctuation">)</span>
requires a<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span>
ensures <span class="token number">0</span> <span class="token operator">&lt;=</span> minIndex <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>Length
ensures forall i <span class="token operator">|</span> <span class="token number">0</span><span class="token operator">&lt;=</span>i<span class="token operator">&lt;</span>a<span class="token punctuation">.</span>Length<span class="token operator">:</span><span class="token operator">:</span>a<span class="token punctuation">[</span>minIndex<span class="token punctuation">]</span><span class="token operator">&lt;=</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
<span class="token punctuation">{</span>
  minIndex<span class="token operator">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> i<span class="token operator">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> i<span class="token operator">&lt;</span>a<span class="token punctuation">.</span>Length
  invariant <span class="token number">0</span><span class="token operator">&lt;=</span>i<span class="token operator">&lt;=</span>a<span class="token punctuation">.</span>Length
  invariant <span class="token number">0</span><span class="token operator">&lt;=</span>minIndex<span class="token operator">&lt;</span>a<span class="token punctuation">.</span>Length
  invariant forall j<span class="token operator">|</span><span class="token number">0</span><span class="token operator">&lt;=</span>j<span class="token operator">&lt;</span>i<span class="token operator">:</span><span class="token operator">:</span>a<span class="token punctuation">[</span>minIndex<span class="token punctuation">]</span><span class="token operator">&lt;=</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;</span>a<span class="token punctuation">[</span>minIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      minIndex <span class="token operator">:</span><span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    i<span class="token operator">:</span><span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>modifies 声明已被改变量（创建副本）</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Pointer</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a<span class="token operator">:</span> array<span class="token operator">&lt;</span>int<span class="token operator">&gt;</span>
  method <span class="token function">InitArray</span><span class="token punctuation">(</span>size<span class="token operator">:</span> nat<span class="token punctuation">)</span>
  modifies <span class="token keyword">this</span>
<span class="token punctuation">{</span>
  <span class="token keyword">var</span> b <span class="token operator">:</span><span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
  a <span class="token operator">:</span><span class="token operator">=</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>if a = [1, 2, 3, 4] then after running CumulativeSum(a), you should have a = [1, 3, 6, 10]</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">SumTo</span><span class="token punctuation">(</span>a<span class="token operator">:</span> array<span class="token operator">&lt;</span>int<span class="token operator">&gt;</span><span class="token punctuation">,</span> i<span class="token operator">:</span> nat<span class="token punctuation">)</span><span class="token operator">:</span> int
reads a
requires <span class="token number">0</span> <span class="token operator">&lt;=</span> i <span class="token operator">&lt;=</span> a<span class="token punctuation">.</span>Length
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span> then <span class="token number">0</span> <span class="token keyword">else</span> <span class="token function">SumTo</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

method <span class="token function">CumulativeSum</span><span class="token punctuation">(</span>a<span class="token operator">:</span> array<span class="token operator">&lt;</span>int<span class="token operator">&gt;</span><span class="token punctuation">)</span>
modifies a <span class="token comment">// 在原数组进行操作</span>
ensures forall i<span class="token operator">|</span><span class="token number">0</span><span class="token operator">&lt;=</span>i<span class="token operator">&lt;</span>a<span class="token punctuation">.</span>Length<span class="token operator">:</span><span class="token operator">:</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">old</span><span class="token punctuation">(</span><span class="token function">SumTo</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">var</span> i<span class="token operator">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> sum<span class="token operator">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>a<span class="token punctuation">.</span>Length<span class="token punctuation">)</span>
    invariant <span class="token number">0</span><span class="token operator">&lt;=</span>i<span class="token operator">&lt;=</span>a<span class="token punctuation">.</span>Length
  invariant forall j<span class="token operator">|</span>i<span class="token operator">&lt;=</span>j<span class="token operator">&lt;</span>a<span class="token punctuation">.</span>Length<span class="token operator">:</span><span class="token operator">:</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">old</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
  invariant sum <span class="token operator">==</span> <span class="token function">old</span><span class="token punctuation">(</span><span class="token function">SumTo</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
  invariant forall j<span class="token operator">|</span><span class="token number">0</span><span class="token operator">&lt;=</span>j<span class="token operator">&lt;</span>i<span class="token operator">:</span><span class="token operator">:</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">old</span><span class="token punctuation">(</span><span class="token function">SumTo</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    sum <span class="token operator">:</span><span class="token operator">=</span> sum <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">:</span><span class="token operator">=</span> sum<span class="token punctuation">;</span>
    i <span class="token operator">:</span><span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2/7/2022, 5:19:45 PM</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#l2-design-by-contract-dbc" class="sidebar-link reco-side-l2-design-by-contract-dbc" data-v-cb1513f6>L2 Design by Contract （DBC）</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#key-concept" class="sidebar-link reco-side-key-concept" data-v-cb1513f6>Key concept</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#main-principles" class="sidebar-link reco-side-main-principles" data-v-cb1513f6>Main principles</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#知识点" class="sidebar-link reco-side-知识点" data-v-cb1513f6>知识点：</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#l3-4-logic-for-program-specification" class="sidebar-link reco-side-l3-4-logic-for-program-specification" data-v-cb1513f6>L3&amp;4 Logic for Program  Specification</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#l5-first-order-logic" class="sidebar-link reco-side-l5-first-order-logic" data-v-cb1513f6>L5 First Order Logic</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#常用逻辑" class="sidebar-link reco-side-常用逻辑" data-v-cb1513f6>常用逻辑</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#l6-natural-deduction-proofs-自然演绎证明" class="sidebar-link reco-side-l6-natural-deduction-proofs-自然演绎证明" data-v-cb1513f6>L6 ⭐️Natural Deduction Proofs (自然演绎证明</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#example" class="sidebar-link reco-side-example" data-v-cb1513f6>Example</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#prasetree" class="sidebar-link reco-side-prasetree" data-v-cb1513f6>PraseTree</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#l8-9-formal-proof-in-logic-cnf-合取范式" class="sidebar-link reco-side-l8-9-formal-proof-in-logic-cnf-合取范式" data-v-cb1513f6>L8&amp;9  ⭐️ Formal Proof in Logic &amp; CNF 合取范式</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#models" class="sidebar-link reco-side-models" data-v-cb1513f6>⭐️Models</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#soundness-合理性" class="sidebar-link reco-side-soundness-合理性" data-v-cb1513f6>⭐️soundness 合理性</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#completeness-完整性" class="sidebar-link reco-side-completeness-完整性" data-v-cb1513f6>⭐️completeness 完整性</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#conjunctive-normal-form-cnf-translation" class="sidebar-link reco-side-conjunctive-normal-form-cnf-translation" data-v-cb1513f6>⭐️Conjunctive Normal Form (CNF) Translation</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#example-2" class="sidebar-link reco-side-example-2" data-v-cb1513f6>Example</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#l10-13-automated-reasoning" class="sidebar-link reco-side-l10-13-automated-reasoning" data-v-cb1513f6>L10-13 AUTOMATED REASONING</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#equisatisfiable-等可以满足的" class="sidebar-link reco-side-equisatisfiable-等可以满足的" data-v-cb1513f6>⭐️equisatisfiable 等可以满足的</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#sat-boolean-satisfiability-problem" class="sidebar-link reco-side-sat-boolean-satisfiability-problem" data-v-cb1513f6>⭐️SAT Boolean satisfiability problem</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#smt-satisfiability-modulo-theories" class="sidebar-link reco-side-smt-satisfiability-modulo-theories" data-v-cb1513f6>⭐️SMT satisfiability modulo theories</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#l14-19hoare-logic-霍尔逻辑" class="sidebar-link reco-side-l14-19hoare-logic-霍尔逻辑" data-v-cb1513f6>L14-19⭐️Hoare Logic 霍尔逻辑</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#hoare-logic-examples" class="sidebar-link reco-side-hoare-logic-examples" data-v-cb1513f6>Hoare Logic Examples</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#hoare-logic-loop" class="sidebar-link reco-side-hoare-logic-loop" data-v-cb1513f6>Hoare Logic Loop</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#model-checking-temporal-logic-模型校验-时间逻辑" class="sidebar-link reco-side-model-checking-temporal-logic-模型校验-时间逻辑" data-v-cb1513f6>⭐️Model checking (temporal logic) 模型校验（时间逻辑）</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#temporal-logic" class="sidebar-link reco-side-temporal-logic" data-v-cb1513f6>temporal logic</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#dafny" class="sidebar-link reco-side-dafny" data-v-cb1513f6>⭐️Dafny</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#声明变量" class="sidebar-link reco-side-声明变量" data-v-cb1513f6>声明变量</a></li><li class="level-2" data-v-cb1513f6><a href="/university/CS357/CS357.html#循环不变量-invariant" class="sidebar-link reco-side-循环不变量-invariant" data-v-cb1513f6>循环不变量 invariant</a></li><li class="level-3" data-v-cb1513f6><a href="/university/CS357/CS357.html#案例" class="sidebar-link reco-side-案例" data-v-cb1513f6>案例</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><!----><!----><div></div></div></div>
    <script src="/assets/js/app.862b4c32.js" defer></script><script src="/assets/js/3.9cc2b3a1.js" defer></script><script src="/assets/js/1.8c30e9e6.js" defer></script><script src="/assets/js/141.d3c21f17.js" defer></script>
  </body>
</html>
