(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{662:function(t,s,a){"use strict";a.r(s);var e=a(5),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"nginx-è¯¦è§£"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-è¯¦è§£"}},[t._v("#")]),t._v(" Nginx è¯¦è§£")]),t._v(" "),a("blockquote",[a("p",[t._v("ä½œè€…ï¼šSHERlocked93\né“¾æ¥ï¼šhttps://juejin.cn/post/6844904144235413512\næ¥æºï¼šç¨€åœŸæ˜é‡‘")])]),t._v(" "),a("h2",{attrs:{id:"_1-nginx-ä»‹ç»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-nginx-ä»‹ç»"}},[t._v("#")]),t._v(" 1. Nginx ä»‹ç»")]),t._v(" "),a("p",[t._v("ä¼ ç»Ÿçš„ Web æœåŠ¡å™¨ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹æˆ–çº¿ç¨‹å¤„ç†ï¼Œéœ€åœ¨åˆ‡æ¢ä»»åŠ¡æ—¶å°† CPU åˆ‡æ¢åˆ°æ–°çš„ä»»åŠ¡å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„è¿è¡Œæ—¶ä¸Šä¸‹æ–‡ï¼Œæ¶ˆè€—é¢å¤–çš„å†…å­˜å’Œ CPU æ—¶é—´ï¼Œå½“å¹¶å‘è¯·æ±‚å¢åŠ æ—¶ï¼ŒæœåŠ¡å™¨å“åº”å˜æ…¢ï¼Œä»è€Œå¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e967b9714ed~tplv-t2oaga2asx-watermark.awebp",alt:"Nginx"}})]),t._v(" "),a("p",[t._v("Nginx æ˜¯å¼€æºã€é«˜æ€§èƒ½ã€é«˜å¯é çš„ Web å’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œè€Œä¸”æ”¯æŒçƒ­éƒ¨ç½²ï¼Œå‡ ä¹å¯ä»¥åšåˆ° 7 * 24 å°æ—¶ä¸é—´æ–­è¿è¡Œï¼Œå³ä½¿è¿è¡Œå‡ ä¸ªæœˆä¹Ÿä¸éœ€è¦é‡æ–°å¯åŠ¨ï¼Œè¿˜èƒ½åœ¨ä¸é—´æ–­æœåŠ¡çš„æƒ…å†µä¸‹å¯¹è½¯ä»¶ç‰ˆæœ¬è¿›è¡Œçƒ­æ›´æ–°ã€‚æ€§èƒ½æ˜¯ Nginx æœ€é‡è¦çš„è€ƒé‡ï¼Œå…¶å ç”¨å†…å­˜å°‘ã€å¹¶å‘èƒ½åŠ›å¼ºã€èƒ½æ”¯æŒé«˜è¾¾ 5w ä¸ªå¹¶å‘è¿æ¥æ•°ï¼Œæœ€é‡è¦çš„æ˜¯ï¼ŒNginx æ˜¯å…è´¹çš„å¹¶å¯ä»¥å•†ä¸šåŒ–ï¼Œé…ç½®ä½¿ç”¨ä¹Ÿæ¯”è¾ƒç®€å•ã€‚")]),t._v(" "),a("p",[t._v("Nginx çš„æœ€é‡è¦çš„å‡ ä¸ªä½¿ç”¨åœºæ™¯ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("é™æ€èµ„æºæœåŠ¡ï¼Œé€šè¿‡æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæä¾›æœåŠ¡ï¼›")]),t._v(" "),a("li",[t._v("åå‘ä»£ç†æœåŠ¡ï¼Œå»¶ä¼¸å‡ºåŒ…æ‹¬ç¼“å­˜ã€è´Ÿè½½å‡è¡¡ç­‰ï¼›")]),t._v(" "),a("li",[t._v("API æœåŠ¡ï¼ŒOpenResty ï¼›")])]),t._v(" "),a("p",[t._v("å¯¹äºå‰ç«¯æ¥è¯´ Node.js ä¸é™Œç”Ÿäº†ï¼ŒNginx å’Œ Node.js çš„å¾ˆå¤šç†å¿µç±»ä¼¼ï¼ŒHTTP æœåŠ¡å™¨ã€äº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥éé˜»å¡ç­‰ï¼Œä¸” Nginx çš„å¤§éƒ¨åˆ†åŠŸèƒ½ä½¿ç”¨ Node.js ä¹Ÿå¯ä»¥å®ç°ï¼Œä½† Nginx å’Œ Node.js å¹¶ä¸å†²çªï¼Œéƒ½æœ‰è‡ªå·±æ“…é•¿çš„é¢†åŸŸã€‚Nginx æ“…é•¿äºåº•å±‚æœåŠ¡å™¨ç«¯èµ„æºçš„å¤„ç†ï¼ˆé™æ€èµ„æºå¤„ç†è½¬å‘ã€åå‘ä»£ç†ï¼Œè´Ÿè½½å‡è¡¡ç­‰ï¼‰ï¼ŒNode.js æ›´æ“…é•¿ä¸Šå±‚å…·ä½“ä¸šåŠ¡é€»è¾‘çš„å¤„ç†ï¼Œä¸¤è€…å¯ä»¥å®Œç¾ç»„åˆï¼Œå…±åŒåŠ©åŠ›å‰ç«¯å¼€å‘ã€‚")]),t._v(" "),a("p",[t._v("ä¸‹é¢æˆ‘ä»¬ç€é‡å­¦ä¹ ä¸€ä¸‹ Nginx çš„ä½¿ç”¨ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_2-ç›¸å…³æ¦‚å¿µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-ç›¸å…³æ¦‚å¿µ"}},[t._v("#")]),t._v(" 2. ç›¸å…³æ¦‚å¿µ")]),t._v(" "),a("h3",{attrs:{id:"_2-1-ç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-ç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚"}},[t._v("#")]),t._v(" 2.1 ç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚")]),t._v(" "),a("p",[t._v("é¦–å…ˆæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚ï¼Œå¦‚æœåŒæ—¶æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ï¼Œå°±å±äºç®€å•è¯·æ±‚ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("è¯·æ±‚æ–¹æ³•æ˜¯ "),a("code",[t._v("HEAD")]),t._v("ã€"),a("code",[t._v("GET")]),t._v("ã€"),a("code",[t._v("POST")]),t._v(" ä¸‰ç§ä¹‹ä¸€ï¼›")]),t._v(" "),a("li",[t._v("HTTP å¤´ä¿¡æ¯ä¸è¶…è¿‡å³è¾¹ç€å‡ ä¸ªå­—æ®µï¼š"),a("code",[t._v("Accept")]),t._v("ã€"),a("code",[t._v("Accept-Language")]),t._v("ã€"),a("code",[t._v("Content-Language")]),t._v("ã€"),a("code",[t._v("Last-Event-ID")]),t._v(" "),a("code",[t._v("Content-Type")]),t._v(" åªé™äºä¸‰ä¸ªå€¼ "),a("code",[t._v("application/x-www-form-urlencoded")]),t._v("ã€"),a("code",[t._v("multipart/form-data")]),t._v("ã€"),a("code",[t._v("text/plain")]),t._v("ï¼›")])]),t._v(" "),a("p",[t._v("å‡¡æ˜¯ä¸åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶çš„ï¼Œéƒ½å±äºéç®€å•è¯·æ±‚ã€‚")]),t._v(" "),a("p",[t._v("æµè§ˆå™¨å¤„ç†ç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚çš„æ–¹å¼ä¸ä¸€æ ·ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("ç®€å•è¯·æ±‚")])]),t._v(" "),a("p",[t._v("å¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šåœ¨å¤´ä¿¡æ¯ä¸­å¢åŠ  "),a("code",[t._v("Origin")]),t._v(" å­—æ®µåç›´æ¥å‘å‡ºï¼Œ"),a("code",[t._v("Origin")]),t._v(" å­—æ®µç”¨æ¥è¯´æ˜ï¼Œæœ¬æ¬¡è¯·æ±‚æ¥è‡ªçš„å“ªä¸ªæºï¼ˆåè®®+åŸŸå+ç«¯å£ï¼‰ã€‚")]),t._v(" "),a("p",[t._v("å¦‚æœæœåŠ¡å™¨å‘ç° "),a("code",[t._v("Origin")]),t._v(" æŒ‡å®šçš„æºä¸åœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„ HTTP å›åº”ï¼Œæµè§ˆå™¨å–åˆ°å›åº”ä¹‹åå‘ç°å›åº”çš„å¤´ä¿¡æ¯ä¸­æ²¡æœ‰åŒ…å« "),a("code",[t._v("Access-Control-Allow-Origin")]),t._v(" å­—æ®µï¼Œå°±æŠ›å‡ºä¸€ä¸ªé”™è¯¯ç»™ XHR çš„ "),a("code",[t._v("error")]),t._v(" äº‹ä»¶ï¼›")]),t._v(" "),a("p",[t._v("å¦‚æœæœåŠ¡å™¨å‘ç° "),a("code",[t._v("Origin")]),t._v(" æŒ‡å®šçš„åŸŸååœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿”å›çš„å“åº”ä¼šå¤šå‡ºå‡ ä¸ª "),a("code",[t._v("Access-Control-")]),t._v(" å¼€å¤´çš„å¤´ä¿¡æ¯å­—æ®µã€‚")]),t._v(" "),a("p",[a("strong",[t._v("éç®€å•è¯·æ±‚")])]),t._v(" "),a("p",[t._v("éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯ "),a("code",[t._v("PUT")]),t._v(" æˆ– "),a("code",[t._v("DELETE")]),t._v("ï¼Œæˆ– "),a("code",[t._v("Content-Type")]),t._v(" å€¼ä¸º "),a("code",[t._v("application/json")]),t._v("ã€‚æµè§ˆå™¨ä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå‘é€ä¸€æ¬¡ HTTP é¢„æ£€ "),a("code",[t._v("OPTIONS")]),t._v(" è¯·æ±‚ï¼Œå…ˆè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº› HTTP è¯·æ±‚æ–¹æ³•å’Œå¤´ä¿¡æ¯å­—æ®µã€‚åªæœ‰å¾—åˆ°è‚¯å®šç­”å¤ï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„ "),a("code",[t._v("XHR")]),t._v(" è¯·æ±‚ï¼Œå¦åˆ™æŠ¥é”™ã€‚")]),t._v(" "),a("h3",{attrs:{id:"_2-2-è·¨åŸŸ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-è·¨åŸŸ"}},[t._v("#")]),t._v(" 2.2 è·¨åŸŸ")]),t._v(" "),a("p",[t._v("åœ¨æµè§ˆå™¨ä¸Šå½“å‰è®¿é—®çš„ç½‘ç«™å‘å¦ä¸€ä¸ªç½‘ç«™å‘é€è¯·æ±‚è·å–æ•°æ®çš„è¿‡ç¨‹å°±æ˜¯"),a("strong",[t._v("è·¨åŸŸè¯·æ±‚")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("è·¨åŸŸæ˜¯æµè§ˆå™¨çš„"),a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSecurity%2FSame-origin_policy",target:"_blank",rel:"noopener noreferrer"}},[t._v("åŒæºç­–ç•¥"),a("OutboundLink")],1),t._v("å†³å®šçš„ï¼Œæ˜¯ä¸€ä¸ªé‡è¦çš„æµè§ˆå™¨å®‰å…¨ç­–ç•¥ï¼Œç”¨äºé™åˆ¶ä¸€ä¸ª "),a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FGlossary%2F%E6%BA%90",target:"_blank",rel:"noopener noreferrer"}},[t._v("origin"),a("OutboundLink")],1),t._v(" çš„æ–‡æ¡£æˆ–è€…å®ƒåŠ è½½çš„è„šæœ¬ä¸å¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©é˜»éš”æ¶æ„æ–‡æ¡£ï¼Œå‡å°‘å¯èƒ½è¢«æ”»å‡»çš„åª’ä»‹ï¼Œå¯ä»¥ä½¿ç”¨ "),a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FGlossary%2FCORS",target:"_blank",rel:"noopener noreferrer"}},[t._v("CORS"),a("OutboundLink")],1),t._v(" é…ç½®è§£é™¤è¿™ä¸ªé™åˆ¶ã€‚")]),t._v(" "),a("p",[t._v("å…³äºè·¨åŸŸç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šè§£é‡Šï¼Œè¿™é‡Œå°±ä¸å•°å—¦ï¼Œä¹Ÿå¯ä»¥ç›´æ¥çœ‹ MDN çš„ "),a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSecurity%2FSame-origin_policy",target:"_blank",rel:"noopener noreferrer"}},[t._v("<æµè§ˆå™¨çš„åŒæºç­–ç•¥>"),a("OutboundLink")],1),t._v(" æ–‡æ¡£è¿›ä¸€æ­¥äº†è§£ï¼Œè¿™é‡Œå°±åˆ—ä¸¾å‡ ä¸ªåŒæºå’Œä¸åŒå…ƒçš„ä¾‹å­ï¼Œç›¸ä¿¡ç¨‹åºå‘˜éƒ½èƒ½çœ‹å¾—æ‡‚ã€‚")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åŒæºçš„ä¾‹å­")]),t._v("\nhttp://example.com/app1/index.html  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åªæ˜¯è·¯å¾„ä¸åŒ")]),t._v("\nhttp://example.com/app2/index.html\n\nhttp://Example.com:80  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åªæ˜¯å¤§å°å†™å·®å¼‚")]),t._v("\nhttp://example.com\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¸åŒæºçš„ä¾‹å­")]),t._v("\nhttp://example.com/app1   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åè®®ä¸åŒ")]),t._v("\nhttps://example.com/app2\n\nhttp://example.com        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# host ä¸åŒ")]),t._v("\nhttp://www.example.com\nhttp://myapp.example.com\n\nhttp://example.com        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç«¯å£ä¸åŒ")]),t._v("\nhttp://example.com:8080\nå¤åˆ¶ä»£ç \n")])])]),a("h3",{attrs:{id:"_2-3-æ­£å‘ä»£ç†å’Œåå‘ä»£ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-æ­£å‘ä»£ç†å’Œåå‘ä»£ç†"}},[t._v("#")]),t._v(" 2.3 æ­£å‘ä»£ç†å’Œåå‘ä»£ç†")]),t._v(" "),a("p",[t._v("åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰å¯¹åº”çš„æ˜¯æ­£å‘ä»£ç†ï¼ˆForward Proxyï¼‰ï¼Œä»–ä»¬çš„åŒºåˆ«ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("æ­£å‘ä»£ç†ï¼š")]),t._v(" ä¸€èˆ¬çš„è®¿é—®æµç¨‹æ˜¯å®¢æˆ·ç«¯ç›´æ¥å‘ç›®æ ‡æœåŠ¡å™¨å‘é€è¯·æ±‚å¹¶è·å–å†…å®¹ï¼Œä½¿ç”¨æ­£å‘ä»£ç†åï¼Œå®¢æˆ·ç«¯æ”¹ä¸ºå‘ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¹¶æŒ‡å®šç›®æ ‡æœåŠ¡å™¨ï¼ˆåŸå§‹æœåŠ¡å™¨ï¼‰ï¼Œç„¶åç”±ä»£ç†æœåŠ¡å™¨å’ŒåŸå§‹æœåŠ¡å™¨é€šä¿¡ï¼Œè½¬äº¤è¯·æ±‚å¹¶è·å¾—çš„å†…å®¹ï¼Œå†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚æ­£å‘ä»£ç†éšè—äº†çœŸå®çš„å®¢æˆ·ç«¯ï¼Œä¸ºå®¢æˆ·ç«¯æ”¶å‘è¯·æ±‚ï¼Œä½¿çœŸå®å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨ä¸å¯è§ï¼›")]),t._v(" "),a("p",[t._v("ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ ğŸŒ°ï¼Œä½ çš„æµè§ˆå™¨æ— æ³•ç›´æ¥è®¿é—®è°·å“¥ï¼Œè¿™æ—¶å€™å¯ä»¥é€šè¿‡ä¸€ä¸ªä»£ç†æœåŠ¡å™¨æ¥å¸®åŠ©ä½ è®¿é—®è°·å“¥ï¼Œé‚£ä¹ˆè¿™ä¸ªæœåŠ¡å™¨å°±å«æ­£å‘ä»£ç†ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("åå‘ä»£ç†ï¼š")]),t._v(" ä¸ä¸€èˆ¬è®¿é—®æµç¨‹ç›¸æ¯”ï¼Œä½¿ç”¨åå‘ä»£ç†åï¼Œç›´æ¥æ”¶åˆ°è¯·æ±‚çš„æœåŠ¡å™¨æ˜¯ä»£ç†æœåŠ¡å™¨ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸ŠçœŸæ­£è¿›è¡Œå¤„ç†çš„æœåŠ¡å™¨ï¼Œå¾—åˆ°çš„ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚åå‘ä»£ç†éšè—äº†çœŸå®çš„æœåŠ¡å™¨ï¼Œä¸ºæœåŠ¡å™¨æ”¶å‘è¯·æ±‚ï¼Œä½¿çœŸå®æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯ä¸å¯è§ã€‚ä¸€èˆ¬åœ¨å¤„ç†è·¨åŸŸè¯·æ±‚çš„æ—¶å€™æ¯”è¾ƒå¸¸ç”¨ã€‚ç°åœ¨åŸºæœ¬ä¸Šæ‰€æœ‰çš„å¤§å‹ç½‘ç«™éƒ½è®¾ç½®äº†åå‘ä»£ç†ã€‚")]),t._v(" "),a("p",[t._v("ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ ğŸŒ°ï¼Œå»é¥­åº—åƒé¥­ï¼Œå¯ä»¥ç‚¹å·èœã€ç²¤èœã€æ±Ÿæµ™èœï¼Œé¥­åº—ä¹Ÿåˆ†åˆ«æœ‰ä¸‰ä¸ªèœç³»çš„å¨å¸ˆ ğŸ‘¨â€ğŸ³ï¼Œä½†æ˜¯ä½ ä½œä¸ºé¡¾å®¢ä¸ç”¨ç®¡å“ªä¸ªå¨å¸ˆç»™ä½ åšçš„èœï¼Œåªç”¨ç‚¹èœå³å¯ï¼Œå°äºŒå°†ä½ èœå•ä¸­çš„èœåˆ†é…ç»™ä¸åŒçš„å¨å¸ˆæ¥å…·ä½“å¤„ç†ï¼Œé‚£ä¹ˆè¿™ä¸ªå°äºŒå°±æ˜¯åå‘ä»£ç†æœåŠ¡å™¨ã€‚")]),t._v(" "),a("p",[t._v("ç®€å•çš„è¯´ï¼Œä¸€èˆ¬ç»™å®¢æˆ·ç«¯åšä»£ç†çš„éƒ½æ˜¯æ­£å‘ä»£ç†ï¼Œç»™æœåŠ¡å™¨åšä»£ç†çš„å°±æ˜¯åå‘ä»£ç†ã€‚")]),t._v(" "),a("p",[t._v("æ­£å‘ä»£ç†å’Œåå‘ä»£ç†ä¸»è¦çš„åŸç†åŒºåˆ«å¯ä»¥å‚è§ä¸‹å›¾ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96d99eecdc~tplv-t2oaga2asx-watermark.awebp",alt:"æ­£å‘ä»£ç†ä¸åå‘ä»£ç†"}})]),t._v(" "),a("h3",{attrs:{id:"_2-4-è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" 2.4 è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[t._v("ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å‘é€å¤šä¸ªè¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†å¯èƒ½è¦æ“ä½œä¸€äº›èµ„æºæ¯”å¦‚æ•°æ®åº“ã€é™æ€èµ„æºç­‰ï¼ŒæœåŠ¡å™¨å¤„ç†å®Œæ¯•åï¼Œå†å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚")]),t._v(" "),a("p",[t._v("è¿™ç§æ¨¡å¼å¯¹äºæ—©æœŸçš„ç³»ç»Ÿæ¥è¯´ï¼ŒåŠŸèƒ½è¦æ±‚ä¸å¤æ‚ï¼Œä¸”å¹¶å‘è¯·æ±‚ç›¸å¯¹è¾ƒå°‘çš„æƒ…å†µä¸‹è¿˜èƒ½èƒœä»»ï¼Œæˆæœ¬ä¹Ÿä½ã€‚éšç€ä¿¡æ¯æ•°é‡ä¸æ–­å¢é•¿ï¼Œè®¿é—®é‡å’Œæ•°æ®é‡é£é€Ÿå¢é•¿ï¼Œä»¥åŠç³»ç»Ÿä¸šåŠ¡å¤æ‚åº¦æŒç»­å¢åŠ ï¼Œè¿™ç§åšæ³•å·²æ— æ³•æ»¡è¶³è¦æ±‚ï¼Œå¹¶å‘é‡ç‰¹åˆ«å¤§æ—¶ï¼ŒæœåŠ¡å™¨å®¹æ˜“å´©ã€‚")]),t._v(" "),a("p",[t._v("å¾ˆæ˜æ˜¾è¿™æ˜¯ç”±äºæœåŠ¡å™¨æ€§èƒ½çš„ç“¶é¢ˆé€ æˆçš„é—®é¢˜ï¼Œé™¤äº†å †æœºå™¨ä¹‹å¤–ï¼Œæœ€é‡è¦çš„åšæ³•å°±æ˜¯è´Ÿè½½å‡è¡¡ã€‚")]),t._v(" "),a("p",[t._v("è¯·æ±‚çˆ†å‘å¼å¢é•¿çš„æƒ…å†µä¸‹ï¼Œå•ä¸ªæœºå™¨æ€§èƒ½å†å¼ºåŠ²ä¹Ÿæ— æ³•æ»¡è¶³è¦æ±‚äº†ï¼Œè¿™ä¸ªæ—¶å€™é›†ç¾¤çš„æ¦‚å¿µäº§ç”Ÿäº†ï¼Œå•ä¸ªæœåŠ¡å™¨è§£å†³ä¸äº†çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œç„¶åå°†è¯·æ±‚åˆ†å‘åˆ°å„ä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†è´Ÿè½½åˆ†å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œè¿™å°±æ˜¯"),a("strong",[t._v("è´Ÿè½½å‡è¡¡")]),t._v("ï¼Œæ ¸å¿ƒæ˜¯ã€Œåˆ†æ‘Šå‹åŠ›ã€ã€‚Nginx å®ç°è´Ÿè½½å‡è¡¡ï¼Œä¸€èˆ¬æ¥è¯´æŒ‡çš„æ˜¯å°†è¯·æ±‚è½¬å‘ç»™æœåŠ¡å™¨é›†ç¾¤ã€‚")]),t._v(" "),a("p",[t._v("ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ ğŸŒ°ï¼Œæ™šé«˜å³°ä¹˜ååœ°é“çš„æ—¶å€™ï¼Œå…¥ç«™å£ç»å¸¸ä¼šæœ‰åœ°é“å·¥ä½œäººå‘˜å¤§å–‡å­â€œè¯·èµ° B å£ï¼ŒB å£äººå°‘è½¦ç©º....â€ï¼Œè¿™ä¸ªå·¥ä½œäººå‘˜çš„ä½œç”¨å°±æ˜¯è´Ÿè½½å‡è¡¡ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/SHERlocked93/pic@env/uPic/2020-03-09-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1.png",alt:"è´Ÿè½½å‡è¡¡"}})]),t._v(" "),a("h3",{attrs:{id:"_2-5-åŠ¨é™åˆ†ç¦»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-åŠ¨é™åˆ†ç¦»"}},[t._v("#")]),t._v(" 2.5 åŠ¨é™åˆ†ç¦»")]),t._v(" "),a("p",[t._v("ä¸ºäº†åŠ å¿«ç½‘ç«™çš„è§£æé€Ÿåº¦ï¼Œå¯ä»¥æŠŠåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢ç”±ä¸åŒçš„æœåŠ¡å™¨æ¥è§£æï¼ŒåŠ å¿«è§£æé€Ÿåº¦ï¼Œé™ä½åŸæ¥å•ä¸ªæœåŠ¡å™¨çš„å‹åŠ›ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/SHERlocked93/pic@env/uPic/2020-03-09-%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB.png",alt:"åŠ¨é™åˆ†ç¦»"}})]),t._v(" "),a("p",[t._v("ä¸€èˆ¬æ¥è¯´ï¼Œéƒ½éœ€è¦å°†åŠ¨æ€èµ„æºå’Œé™æ€èµ„æºåˆ†å¼€ï¼Œç”±äº Nginx çš„é«˜å¹¶å‘å’Œé™æ€èµ„æºç¼“å­˜ç­‰ç‰¹æ€§ï¼Œç»å¸¸å°†é™æ€èµ„æºéƒ¨ç½²åœ¨ Nginx ä¸Šã€‚å¦‚æœè¯·æ±‚çš„æ˜¯é™æ€èµ„æºï¼Œç›´æ¥åˆ°é™æ€èµ„æºç›®å½•è·å–èµ„æºï¼Œå¦‚æœæ˜¯åŠ¨æ€èµ„æºçš„è¯·æ±‚ï¼Œåˆ™åˆ©ç”¨åå‘ä»£ç†çš„åŸç†ï¼ŒæŠŠè¯·æ±‚è½¬å‘ç»™å¯¹åº”åå°åº”ç”¨å»å¤„ç†ï¼Œä»è€Œå®ç°åŠ¨é™åˆ†ç¦»ã€‚")]),t._v(" "),a("p",[t._v("ä½¿ç”¨å‰åç«¯åˆ†ç¦»åï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦æå‡é™æ€èµ„æºçš„è®¿é—®é€Ÿåº¦ï¼Œå³ä½¿åŠ¨æ€æœåŠ¡ä¸å¯ç”¨ï¼Œé™æ€èµ„æºçš„è®¿é—®ä¹Ÿä¸ä¼šå—åˆ°å½±å“ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_3-nginx-å¿«é€Ÿå®‰è£…"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-nginx-å¿«é€Ÿå®‰è£…"}},[t._v("#")]),t._v(" 3. Nginx å¿«é€Ÿå®‰è£…")]),t._v(" "),a("h3",{attrs:{id:"_3-1-å®‰è£…"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-å®‰è£…"}},[t._v("#")]),t._v(" 3.1 å®‰è£…")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yum list "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" nginx\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("æ¥çœ‹çœ‹")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e967ad35156~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200307180412726"}})]),t._v(" "),a("p",[t._v("ç„¶å")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" nginx\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("æ¥å®‰è£… Nginxï¼Œç„¶åæˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­ "),a("code",[t._v("nginx -v")]),t._v(" å°±å¯ä»¥çœ‹åˆ°å…·ä½“çš„ Nginx ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¹Ÿå°±å®‰è£…å®Œæ¯•äº†ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e967cd99d22~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200307180545816"}})]),t._v(" "),a("h3",{attrs:{id:"_3-2-ç›¸å…³æ–‡ä»¶å¤¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-ç›¸å…³æ–‡ä»¶å¤¹"}},[t._v("#")]),t._v(" 3.2 ç›¸å…³æ–‡ä»¶å¤¹")]),t._v(" "),a("p",[t._v("ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ "),a("code",[t._v("rpm -ql nginx")]),t._v(" æ¥æŸ¥çœ‹ Nginx è¢«å®‰è£…åˆ°äº†ä»€ä¹ˆåœ°æ–¹ï¼Œæœ‰å“ªäº›ç›¸å…³ç›®å½•ï¼Œå…¶ä¸­ä½äº "),a("code",[t._v("/etc")]),t._v(" ç›®å½•ä¸‹çš„ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€äº›æ–‡ä»¶è§ä¸‹å›¾ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e969c75753f~tplv-t2oaga2asx-watermark.awebp",alt:"Xnip2020-03-07_21-46-11"}})]),t._v(" "),a("p",[t._v("ä¸»è¦å…³æ³¨çš„æ–‡ä»¶å¤¹æœ‰ä¸¤ä¸ªï¼š")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("/etc/nginx/conf.d/")]),t._v(" æ–‡ä»¶å¤¹ï¼Œæ˜¯æˆ‘ä»¬è¿›è¡Œå­é…ç½®çš„é…ç½®é¡¹å­˜æ”¾å¤„ï¼Œ"),a("code",[t._v("/etc/nginx/nginx.conf")]),t._v(" ä¸»é…ç½®æ–‡ä»¶ä¼šé»˜è®¤æŠŠè¿™ä¸ªæ–‡ä»¶å¤¹ä¸­æ‰€æœ‰å­é…ç½®é¡¹éƒ½å¼•å…¥ï¼›")]),t._v(" "),a("li",[a("code",[t._v("/usr/share/nginx/html/")]),t._v(" æ–‡ä»¶å¤¹ï¼Œé€šå¸¸é™æ€æ–‡ä»¶éƒ½æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œä¹Ÿå¯ä»¥æ ¹æ®ä½ è‡ªå·±çš„ä¹ æƒ¯æ”¾å…¶ä»–åœ°æ–¹ï¼›")])]),t._v(" "),a("h3",{attrs:{id:"_3-3-è·‘èµ·æ¥åº·åº·"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-è·‘èµ·æ¥åº·åº·"}},[t._v("#")]),t._v(" 3.3 è·‘èµ·æ¥åº·åº·")]),t._v(" "),a("p",[t._v("å®‰è£…ä¹‹åå¼€å¯ Nginxï¼Œå¦‚æœç³»ç»Ÿå¼€å¯äº†é˜²ç«å¢™ï¼Œé‚£ä¹ˆéœ€è¦è®¾ç½®ä¸€ä¸‹åœ¨é˜²ç«å¢™ä¸­åŠ å…¥éœ€è¦å¼€æ”¾çš„ç«¯å£ï¼Œä¸‹é¢åˆ—ä¸¾å‡ ä¸ªå¸¸ç”¨çš„é˜²ç«å¢™æ“ä½œï¼ˆæ²¡å¼€å¯çš„è¯ä¸ç”¨ç®¡è¿™ä¸ªï¼‰ï¼š")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("systemctl start firewalld  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¼€å¯é˜²ç«å¢™")]),t._v("\nsystemctl stop firewalld   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å…³é—­é˜²ç«å¢™")]),t._v("\nsystemctl status firewalld "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æŸ¥çœ‹é˜²ç«å¢™å¼€å¯çŠ¶æ€ï¼Œæ˜¾ç¤ºrunningåˆ™æ˜¯æ­£åœ¨è¿è¡Œ")]),t._v("\nfirewall-cmd --reload      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é‡å¯é˜²ç«å¢™ï¼Œæ°¸ä¹…æ‰“å¼€ç«¯å£éœ€è¦reloadä¸€ä¸‹")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ·»åŠ å¼€å¯ç«¯å£ï¼Œ--permanentè¡¨ç¤ºæ°¸ä¹…æ‰“å¼€ï¼Œä¸åŠ æ˜¯ä¸´æ—¶æ‰“å¼€é‡å¯ä¹‹åå¤±æ•ˆ")]),t._v("\nfirewall-cmd --permanent --zone"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8888")]),t._v("/tcp\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æŸ¥çœ‹é˜²ç«å¢™ï¼Œæ·»åŠ çš„ç«¯å£ä¹Ÿå¯ä»¥çœ‹åˆ°")]),t._v("\nfirewall-cmd --list-all\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("ç„¶åè®¾ç½® Nginx çš„å¼€æœºå¯åŠ¨ï¼š")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" nginx\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("å¯åŠ¨ Nginx ï¼ˆå…¶ä»–å‘½ä»¤åé¢æœ‰è¯¦ç»†è®²è§£ï¼‰ï¼š")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("systemctl start nginx\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("ç„¶åè®¿é—®ä½ çš„ IPï¼Œè¿™æ—¶å€™å°±å¯ä»¥çœ‹åˆ° Nginx çš„æ¬¢è¿é¡µé¢äº†ï½ "),a("code",[t._v("Welcome to nginxï¼")]),t._v(" ğŸ‘")]),t._v(" "),a("h3",{attrs:{id:"_3-4-å®‰è£…-nvm-node-git"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-å®‰è£…-nvm-node-git"}},[t._v("#")]),t._v(" 3.4 å®‰è£… nvm & node & git")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¸‹è½½ nvmï¼Œæˆ–è€…çœ‹å®˜ç½‘çš„æ­¥éª¤ https://github.com/nvm-sh/nvm#install--update-script")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v("   ~/.bashrc    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å®‰è£…å®Œæ¯•åï¼Œæ›´æ–°é…ç½®æ–‡ä»¶å³å¯ä½¿ç”¨ nvm å‘½ä»¤")]),t._v("\nnvm ls-remote         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æŸ¥çœ‹è¿œç¨‹ node ç‰ˆæœ¬")]),t._v("\nnvm "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" v12.16.3  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é€‰ä¸€ä¸ªä½ è¦å®‰è£…çš„ç‰ˆæœ¬å®‰è£…ï¼Œæˆ‘è¿™é‡Œé€‰æ‹© 12.16.3")]),t._v("\nnvm list              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å®‰è£…å®Œæ¯•æŸ¥çœ‹å®‰è£…çš„ node ç‰ˆæœ¬")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("node")]),t._v(" -v               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æŸ¥çœ‹æ˜¯å¦å®‰è£…å¥½äº†")]),t._v("\n\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git å®‰è£…")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h2",{attrs:{id:"_4-nginx-æ“ä½œå¸¸ç”¨å‘½ä»¤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-nginx-æ“ä½œå¸¸ç”¨å‘½ä»¤"}},[t._v("#")]),t._v(" 4. Nginx æ“ä½œå¸¸ç”¨å‘½ä»¤")]),t._v(" "),a("p",[t._v("Nginx çš„å‘½ä»¤åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ "),a("code",[t._v("nginx -h")]),t._v(" å°±å¯ä»¥çœ‹åˆ°å®Œæ•´çš„å‘½ä»¤ï¼Œè¿™é‡Œåˆ—ä¸¾å‡ ä¸ªå¸¸ç”¨çš„å‘½ä»¤ï¼š")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("nginx -s reload  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å‘ä¸»è¿›ç¨‹å‘é€ä¿¡å·ï¼Œé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œçƒ­é‡å¯")]),t._v("\nnginx -s reopen\t "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é‡å¯ Nginx")]),t._v("\nnginx -s stop    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¿«é€Ÿå…³é—­")]),t._v("\nnginx -s quit    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç­‰å¾…å·¥ä½œè¿›ç¨‹å¤„ç†å®Œæˆåå…³é—­")]),t._v("\nnginx -T         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æŸ¥çœ‹å½“å‰ Nginx æœ€ç»ˆçš„é…ç½®")]),t._v("\nnginx -t -c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("é…ç½®è·¯å¾„"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ£€æŸ¥é…ç½®æ˜¯å¦æœ‰é—®é¢˜ï¼Œå¦‚æœå·²ç»åœ¨é…ç½®ç›®å½•ï¼Œåˆ™ä¸éœ€è¦-c")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[a("code",[t._v("systemctl")]),t._v(" æ˜¯ Linux ç³»ç»Ÿåº”ç”¨ç®¡ç†å·¥å…· "),a("code",[t._v("systemd")]),t._v(" çš„ä¸»å‘½ä»¤ï¼Œç”¨äºç®¡ç†ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å®ƒæ¥å¯¹ Nginx è¿›è¡Œç®¡ç†ï¼Œç›¸å…³å‘½ä»¤å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("systemctl start nginx    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¯åŠ¨ Nginx")]),t._v("\nsystemctl stop nginx     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åœæ­¢ Nginx")]),t._v("\nsystemctl restart nginx  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é‡å¯ Nginx")]),t._v("\nsystemctl reload nginx   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é‡æ–°åŠ è½½ Nginxï¼Œç”¨äºä¿®æ”¹é…ç½®å")]),t._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" nginx   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è®¾ç½®å¼€æœºå¯åŠ¨ Nginx")]),t._v("\nsystemctl disable nginx  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å…³é—­å¼€æœºå¯åŠ¨ Nginx")]),t._v("\nsystemctl status nginx   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æŸ¥çœ‹ Nginx è¿è¡ŒçŠ¶æ€")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h2",{attrs:{id:"_5-nginx-é…ç½®è¯­æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-nginx-é…ç½®è¯­æ³•"}},[t._v("#")]),t._v(" 5. Nginx é…ç½®è¯­æ³•")]),t._v(" "),a("p",[t._v("å°±è·Ÿå‰é¢æ–‡ä»¶ä½œç”¨è®²è§£çš„å›¾æ‰€ç¤ºï¼ŒNginx çš„ä¸»é…ç½®æ–‡ä»¶æ˜¯ "),a("code",[t._v("/etc/nginx/nginx.conf")]),t._v("ï¼Œä½ å¯ä»¥ä½¿ç”¨ "),a("code",[t._v("cat -n nginx.conf")]),t._v(" æ¥æŸ¥çœ‹é…ç½®ã€‚")]),t._v(" "),a("p",[a("code",[t._v("nginx.conf")]),t._v(" ç»“æ„å›¾å¯ä»¥è¿™æ ·æ¦‚æ‹¬ï¼š")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("main        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å…¨å±€é…ç½®ï¼Œå¯¹å…¨å±€ç”Ÿæ•ˆ")]),t._v("\nâ”œâ”€â”€ events  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é…ç½®å½±å“ Nginx æœåŠ¡å™¨æˆ–ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥")]),t._v("\nâ”œâ”€â”€ http    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é…ç½®ä»£ç†ï¼Œç¼“å­˜ï¼Œæ—¥å¿—å®šä¹‰ç­‰ç»å¤§å¤šæ•°åŠŸèƒ½å’Œç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®")]),t._v("\nâ”‚   â”œâ”€â”€ upstream "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é…ç½®åç«¯æœåŠ¡å™¨å…·ä½“åœ°å€ï¼Œè´Ÿè½½å‡è¡¡é…ç½®ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†")]),t._v("\nâ”‚   â”œâ”€â”€ server   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é…ç½®è™šæ‹Ÿä¸»æœºçš„ç›¸å…³å‚æ•°ï¼Œä¸€ä¸ª http å—ä¸­å¯ä»¥æœ‰å¤šä¸ª server å—")]),t._v("\nâ”‚   â”œâ”€â”€ server\nâ”‚   â”‚   â”œâ”€â”€ location  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# server å—å¯ä»¥åŒ…å«å¤šä¸ª location å—ï¼Œlocation æŒ‡ä»¤ç”¨äºåŒ¹é… uri")]),t._v("\nâ”‚   â”‚   â”œâ”€â”€ location\nâ”‚   â”‚   â””â”€â”€ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nâ”‚   â””â”€â”€ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nâ””â”€â”€ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),a("p",[t._v("ä¸€ä¸ª Nginx é…ç½®æ–‡ä»¶çš„ç»“æ„å°±åƒ "),a("code",[t._v("nginx.conf")]),t._v(" æ˜¾ç¤ºçš„é‚£æ ·ï¼Œé…ç½®æ–‡ä»¶çš„è¯­æ³•è§„åˆ™ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("é…ç½®æ–‡ä»¶ç”±æŒ‡ä»¤ä¸æŒ‡ä»¤å—æ„æˆï¼›")]),t._v(" "),a("li",[t._v("æ¯æ¡æŒ‡ä»¤ä»¥ "),a("code",[t._v(";")]),t._v(" åˆ†å·ç»“å°¾ï¼ŒæŒ‡ä»¤ä¸å‚æ•°é—´ä»¥ç©ºæ ¼ç¬¦å·åˆ†éš”ï¼›")]),t._v(" "),a("li",[t._v("æŒ‡ä»¤å—ä»¥ "),a("code",[t._v("{}")]),t._v(" å¤§æ‹¬å·å°†å¤šæ¡æŒ‡ä»¤ç»„ç»‡åœ¨ä¸€èµ·ï¼›")]),t._v(" "),a("li",[a("code",[t._v("include")]),t._v(" è¯­å¥å…è®¸ç»„åˆå¤šä¸ªé…ç½®æ–‡ä»¶ä»¥æå‡å¯ç»´æŠ¤æ€§ï¼›")]),t._v(" "),a("li",[t._v("ä½¿ç”¨ "),a("code",[t._v("#")]),t._v(" ç¬¦å·æ·»åŠ æ³¨é‡Šï¼Œæé«˜å¯è¯»æ€§ï¼›")]),t._v(" "),a("li",[t._v("ä½¿ç”¨ "),a("code",[t._v("$")]),t._v(" ç¬¦å·ä½¿ç”¨å˜é‡ï¼›")]),t._v(" "),a("li",[t._v("éƒ¨åˆ†æŒ‡ä»¤çš„å‚æ•°æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼›")])]),t._v(" "),a("h3",{attrs:{id:"_5-1-å…¸å‹é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-å…¸å‹é…ç½®"}},[t._v("#")]),t._v(" 5.1 å…¸å‹é…ç½®")]),t._v(" "),a("p",[t._v("Nginx çš„å…¸å‹é…ç½®ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),t._v("  nginx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è¿è¡Œç”¨æˆ·ï¼Œé»˜è®¤å³æ˜¯nginxï¼Œå¯ä»¥ä¸è¿›è¡Œè®¾ç½®")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("worker_processes")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Nginx è¿›ç¨‹æ•°ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºå’Œ CPU æ ¸æ•°ä¸€æ ·")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_log")]),t._v("  /var/log/nginx/error.log warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Nginx çš„é”™è¯¯æ—¥å¿—å­˜æ”¾ç›®å½•")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pid")]),t._v("        /var/run/nginx.pid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Nginx æœåŠ¡å¯åŠ¨æ—¶çš„ pid å­˜æ”¾ä½ç½®")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("events")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" epoll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä½¿ç”¨epollçš„I/Oæ¨¡å‹(å¦‚æœä½ ä¸çŸ¥é“Nginxè¯¥ä½¿ç”¨å“ªç§è½®è¯¢æ–¹æ³•ï¼Œä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªæœ€é€‚åˆä½ æ“ä½œç³»ç»Ÿçš„)")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("worker_connections")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ¯ä¸ªè¿›ç¨‹å…è®¸æœ€å¤§å¹¶å‘æ•°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é…ç½®ä½¿ç”¨æœ€é¢‘ç¹çš„éƒ¨åˆ†ï¼Œä»£ç†ã€ç¼“å­˜ã€æ—¥å¿—å®šä¹‰ç­‰ç»å¤§å¤šæ•°åŠŸèƒ½å’Œç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®éƒ½åœ¨è¿™é‡Œè®¾ç½®")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è®¾ç½®æ—¥å¿—æ¨¡å¼")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("log_format")]),t._v("  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),t._v(" - "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_user")]),t._v(" ["),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$time_local]")]),t._v(' "'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request")]),t._v("\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$status")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$body_bytes_sent")]),t._v(' "'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_referer")]),t._v("\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\""),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_user_agent")]),t._v('" "'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_x_forwarded_for")]),t._v("\"'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("access_log")]),t._v("  /var/log/nginx/access.log  main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Nginxè®¿é—®æ—¥å¿—å­˜æ”¾ä½ç½®")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sendfile")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¼€å¯é«˜æ•ˆä¼ è¾“æ¨¡å¼")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tcp_nopush")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å‡å°‘ç½‘ç»œæŠ¥æ–‡æ®µçš„æ•°é‡")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tcp_nodelay")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("keepalive_timeout")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¿æŒè¿æ¥çš„æ—¶é—´ï¼Œä¹Ÿå«è¶…æ—¶æ—¶é—´ï¼Œå•ä½ç§’")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("types_hash_max_size")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("include")]),t._v("             /etc/nginx/mime.types")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–‡ä»¶æ‰©å±•åä¸ç±»å‹æ˜ å°„è¡¨")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default_type")]),t._v("        application/octet-stream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é»˜è®¤æ–‡ä»¶ç±»å‹")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("include")]),t._v(" /etc/nginx/conf.d/*.conf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åŠ è½½å­é…ç½®é¡¹")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é…ç½®ç›‘å¬çš„ç«¯å£")]),t._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  localhost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é…ç½®çš„åŸŸå")]),t._v("\n    \t\n    \t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("   /usr/share/nginx/html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç½‘ç«™æ ¹ç›®å½•")]),t._v("\n    \t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("  index.html index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é»˜è®¤é¦–é¡µæ–‡ä»¶")]),t._v("\n    \t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("deny")]),t._v(" 172.168.22.11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç¦æ­¢è®¿é—®çš„ipåœ°å€ï¼Œå¯ä»¥ä¸ºall")]),t._v("\n    \t\tallow 172.168.33.44ï¼› "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å…è®¸è®¿é—®çš„ipåœ°å€ï¼Œå¯ä»¥ä¸ºall")]),t._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \t\n    \t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_page")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("502")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("503")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("504")]),t._v(" /50x.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é»˜è®¤50xå¯¹åº”çš„è®¿é—®é¡µé¢")]),t._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_page")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),t._v(" error.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åŒä¸Š")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("server å—å¯ä»¥åŒ…å«å¤šä¸ª location å—ï¼Œlocation æŒ‡ä»¤ç”¨äºåŒ¹é… uriï¼Œè¯­æ³•ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" [ = | ~ | ~* | ^~] uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t...\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("æŒ‡ä»¤åé¢ï¼š")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("=")]),t._v(" ç²¾ç¡®åŒ¹é…è·¯å¾„ï¼Œç”¨äºä¸å«æ­£åˆ™è¡¨è¾¾å¼çš„ uri å‰ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œä¸å†è¿›è¡Œåç»­çš„æŸ¥æ‰¾ï¼›")]),t._v(" "),a("li",[a("code",[t._v("^~")]),t._v(" ç”¨äºä¸å«æ­£åˆ™è¡¨è¾¾å¼çš„ uriï¼› å‰ï¼Œè¡¨ç¤ºå¦‚æœè¯¥ç¬¦å·åé¢çš„å­—ç¬¦æ˜¯æœ€ä½³åŒ¹é…ï¼Œé‡‡ç”¨è¯¥è§„åˆ™ï¼Œä¸å†è¿›è¡Œåç»­çš„æŸ¥æ‰¾ï¼›")]),t._v(" "),a("li",[a("code",[t._v("~")]),t._v(" è¡¨ç¤ºç”¨è¯¥ç¬¦å·åé¢çš„æ­£åˆ™å»åŒ¹é…è·¯å¾„ï¼ŒåŒºåˆ†å¤§å°å†™ï¼›")]),t._v(" "),a("li",[a("code",[t._v("~*")]),t._v(" è¡¨ç¤ºç”¨è¯¥ç¬¦å·åé¢çš„æ­£åˆ™å»åŒ¹é…è·¯å¾„ï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚è·Ÿ "),a("code",[t._v("~")]),t._v(" ä¼˜å…ˆçº§éƒ½æ¯”è¾ƒä½ï¼Œå¦‚æœ‰å¤šä¸ªlocationçš„æ­£åˆ™èƒ½åŒ¹é…çš„è¯ï¼Œåˆ™ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœ€é•¿çš„é‚£ä¸ªï¼›")])]),t._v(" "),a("p",[t._v("å¦‚æœ uri åŒ…å«æ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ™å¿…é¡»è¦æœ‰ "),a("code",[t._v("~")]),t._v(" æˆ– "),a("code",[t._v("~*")]),t._v(" æ ‡å¿—ã€‚")]),t._v(" "),a("h3",{attrs:{id:"_5-2-å…¨å±€å˜é‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-å…¨å±€å˜é‡"}},[t._v("#")]),t._v(" 5.2 å…¨å±€å˜é‡")]),t._v(" "),a("p",[t._v("Nginx æœ‰ä¸€äº›å¸¸ç”¨çš„å…¨å±€å˜é‡ï¼Œä½ å¯ä»¥åœ¨é…ç½®çš„ä»»ä½•ä½ç½®ä½¿ç”¨å®ƒä»¬ï¼Œå¦‚ä¸‹è¡¨ï¼š")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("å…¨å±€å˜é‡å")]),t._v(" "),a("th",[t._v("åŠŸèƒ½")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("$host")])]),t._v(" "),a("td",[t._v("è¯·æ±‚ä¿¡æ¯ä¸­çš„ "),a("code",[t._v("Host")]),t._v("ï¼Œå¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰ "),a("code",[t._v("Host")]),t._v(" è¡Œï¼Œåˆ™ç­‰äºè®¾ç½®çš„æœåŠ¡å™¨åï¼Œä¸åŒ…å«ç«¯å£")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$request_method")])]),t._v(" "),a("td",[t._v("å®¢æˆ·ç«¯è¯·æ±‚ç±»å‹ï¼Œå¦‚ "),a("code",[t._v("GET")]),t._v("ã€"),a("code",[t._v("POST")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$remote_addr")])]),t._v(" "),a("td",[t._v("å®¢æˆ·ç«¯çš„ "),a("code",[t._v("IP")]),t._v(" åœ°å€")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$args")])]),t._v(" "),a("td",[t._v("è¯·æ±‚ä¸­çš„å‚æ•°")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$arg_PARAMETER")])]),t._v(" "),a("td",[a("code",[t._v("GET")]),t._v(" è¯·æ±‚ä¸­å˜é‡å PARAMETER å‚æ•°çš„å€¼ï¼Œä¾‹å¦‚ï¼š"),a("code",[t._v("$http_user_agent")]),t._v("(Uaer-Agent å€¼), "),a("code",[t._v("$http_referer")]),t._v("...")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$content_length")])]),t._v(" "),a("td",[t._v("è¯·æ±‚å¤´ä¸­çš„ "),a("code",[t._v("Content-length")]),t._v(" å­—æ®µ")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$http_user_agent")])]),t._v(" "),a("td",[t._v("å®¢æˆ·ç«¯agentä¿¡æ¯")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$http_cookie")])]),t._v(" "),a("td",[t._v("å®¢æˆ·ç«¯cookieä¿¡æ¯")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$remote_addr")])]),t._v(" "),a("td",[t._v("å®¢æˆ·ç«¯çš„IPåœ°å€")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$remote_port")])]),t._v(" "),a("td",[t._v("å®¢æˆ·ç«¯çš„ç«¯å£")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$http_user_agent")])]),t._v(" "),a("td",[t._v("å®¢æˆ·ç«¯agentä¿¡æ¯")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$server_protocol")])]),t._v(" "),a("td",[t._v("è¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œå¦‚ "),a("code",[t._v("HTTP/1.0")]),t._v("ã€"),a("code",[t._v("HTTP/1.1")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$server_addr")])]),t._v(" "),a("td",[t._v("æœåŠ¡å™¨åœ°å€")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$server_name")])]),t._v(" "),a("td",[t._v("æœåŠ¡å™¨åç§°")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$server_port")])]),t._v(" "),a("td",[t._v("æœåŠ¡å™¨çš„ç«¯å£å·")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("$scheme")])]),t._v(" "),a("td",[t._v("HTTP æ–¹æ³•ï¼ˆå¦‚httpï¼Œhttpsï¼‰")])])])]),t._v(" "),a("p",[t._v("è¿˜æœ‰æ›´å¤šçš„å†…ç½®é¢„å®šä¹‰å˜é‡ï¼Œå¯ä»¥ç›´æ¥æœç´¢å…³é”®å­—ã€Œnginxå†…ç½®é¢„å®šä¹‰å˜é‡ã€å¯ä»¥çœ‹åˆ°ä¸€å †åšå®¢å†™è¿™ä¸ªï¼Œè¿™äº›å˜é‡éƒ½å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ç›´æ¥ä½¿ç”¨ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_6-è®¾ç½®äºŒçº§åŸŸåè™šæ‹Ÿä¸»æœº"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-è®¾ç½®äºŒçº§åŸŸåè™šæ‹Ÿä¸»æœº"}},[t._v("#")]),t._v(" 6. è®¾ç½®äºŒçº§åŸŸåè™šæ‹Ÿä¸»æœº")]),t._v(" "),a("p",[t._v("åœ¨æŸæŸäº‘ â˜ï¸ ä¸Šè´­ä¹°äº†åŸŸåä¹‹åï¼Œå°±å¯ä»¥é…ç½®è™šæ‹Ÿä¸»æœºäº†ï¼Œä¸€èˆ¬é…ç½®çš„è·¯å¾„åœ¨ "),a("code",[t._v("åŸŸåç®¡ç† -> è§£æ -> æ·»åŠ è®°å½•")]),t._v(" ä¸­æ·»åŠ äºŒçº§åŸŸåï¼Œé…ç½®åæŸæŸäº‘ä¼šæŠŠäºŒçº§åŸŸåä¹Ÿè§£æåˆ°æˆ‘ä»¬é…ç½®çš„æœåŠ¡å™¨ IP ä¸Šï¼Œç„¶åæˆ‘ä»¬åœ¨ Nginx ä¸Šé…ç½®ä¸€ä¸‹è™šæ‹Ÿä¸»æœºçš„è®¿é—®ç›‘å¬ï¼Œå°±å¯ä»¥æ‹¿åˆ°ä»è¿™ä¸ªäºŒçº§åŸŸåè¿‡æ¥çš„è¯·æ±‚äº†ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96a168c66a~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200426150644768"}})]),t._v(" "),a("p",[t._v("ç°åœ¨æˆ‘è‡ªå·±çš„æœåŠ¡å™¨ä¸Šé…ç½®äº†ä¸€ä¸ª fe çš„äºŒçº§åŸŸåï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å¤–ç½‘è®¿é—® "),a("code",[t._v("fe.sherlocked93.club")]),t._v(" çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥è®¿é—®åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨äº†ã€‚")]),t._v(" "),a("p",[t._v("ç”±äºé»˜è®¤é…ç½®æ–‡ä»¶ "),a("code",[t._v("/etc/nginx/nginx.conf")]),t._v(" çš„ http æ¨¡å—ä¸­æœ‰ä¸€å¥ "),a("code",[t._v("include /etc/nginx/conf.d/*.conf")]),t._v(" ä¹Ÿå°±æ˜¯è¯´ "),a("code",[t._v("conf.d")]),t._v(" æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰ "),a("code",[t._v("*.conf")]),t._v(" æ–‡ä»¶éƒ½ä¼šä½œä¸ºå­é…ç½®é¡¹è¢«å¼•å…¥é…ç½®æ–‡ä»¶ä¸­ã€‚ä¸ºäº†ç»´æŠ¤æ–¹ä¾¿ï¼Œæˆ‘åœ¨ "),a("code",[t._v("/etc/nginx/conf.d")]),t._v(" æ–‡ä»¶å¤¹ä¸­æ–°å»ºä¸€ä¸ª "),a("code",[t._v("fe.sherlocked93.club.conf")]),t._v(" ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/nginx/conf.d/fe.sherlocked93.club.conf")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" fe.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("  /usr/share/nginx/html/fe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" index.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("ç„¶ååœ¨ "),a("code",[t._v("/usr/share/nginx/html")]),t._v(" æ–‡ä»¶å¤¹ä¸‹æ–°å»º fe æ–‡ä»¶å¤¹ï¼Œæ–°å»ºæ–‡ä»¶ "),a("code",[t._v("index.html")]),t._v("ï¼Œå†…å®¹éšä¾¿å†™ç‚¹ï¼Œæ”¹å®Œ "),a("code",[t._v("nginx -s reload")]),t._v(" é‡æ–°åŠ è½½ï¼Œæµè§ˆå™¨ä¸­è¾“å…¥ "),a("code",[t._v("fe.sherlocked93.club")]),t._v("ï¼Œå‘ç°ä»äºŒçº§åŸŸåå°±å¯ä»¥è®¿é—®åˆ°æˆ‘ä»¬åˆšåˆšæ–°å»ºçš„ fe æ–‡ä»¶å¤¹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96a60a5e51~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200426153006505"}})]),t._v(" "),a("h2",{attrs:{id:"_7-é…ç½®åå‘ä»£ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-é…ç½®åå‘ä»£ç†"}},[t._v("#")]),t._v(" 7. é…ç½®åå‘ä»£ç†")]),t._v(" "),a("p",[t._v("åå‘ä»£ç†æ˜¯å·¥ä½œä¸­æœ€å¸¸ç”¨çš„æœåŠ¡å™¨åŠŸèƒ½ï¼Œç»å¸¸è¢«ç”¨æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Œä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•å®ç°åå‘ä»£ç†ã€‚")]),t._v(" "),a("p",[t._v("é¦–å…ˆè¿›å…¥ Nginx çš„ä¸»é…ç½®æ–‡ä»¶ï¼š")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/nginx/nginx.conf\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("ä¸ºäº†çœ‹èµ·æ¥æ–¹ä¾¿ï¼ŒæŠŠè¡Œå·æ˜¾ç¤ºå‡ºæ¥ "),a("code",[t._v(":set nu")]),t._v(" ï¼ˆä¸ªäººä¹ æƒ¯ï¼‰ï¼Œç„¶åæˆ‘ä»¬å» "),a("code",[t._v("http")]),t._v(" æ¨¡å—çš„ "),a("code",[t._v("server")]),t._v(" å—ä¸­çš„ "),a("code",[t._v("location /")]),t._v("ï¼Œå¢åŠ ä¸€è¡Œå°†é»˜è®¤ç½‘å€é‡å®šå‘åˆ°æœ€å¤§å­¦ä¹ ç½‘ç«™ Bilibili çš„ "),a("code",[t._v("proxy_pass")]),t._v(" é…ç½® ğŸ¤“ ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96a6d7033c~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200311153131642"}})]),t._v(" "),a("p",[t._v("æ”¹å®Œä¿å­˜é€€å‡ºï¼Œ"),a("code",[t._v("nginx -s reload")]),t._v(" é‡æ–°åŠ è½½ï¼Œè¿›å…¥é»˜è®¤ç½‘å€ï¼Œé‚£ä¹ˆç°åœ¨å°±ç›´æ¥è·³è½¬åˆ° B ç«™äº†ï¼Œå®ç°äº†ä¸€ä¸ªç®€å•çš„ä»£ç†ã€‚")]),t._v(" "),a("p",[t._v("å®é™…ä½¿ç”¨ä¸­ï¼Œå¯ä»¥å°†è¯·æ±‚è½¬å‘åˆ°æœ¬æœºå¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œä¹Ÿå¯ä»¥æ ¹æ®è®¿é—®çš„è·¯å¾„è·³è½¬åˆ°ä¸åŒç«¯å£çš„æœåŠ¡ä¸­ã€‚")]),t._v(" "),a("p",[t._v("æ¯”å¦‚æˆ‘ä»¬ç›‘å¬ "),a("code",[t._v("9001")]),t._v(" ç«¯å£ï¼Œç„¶åæŠŠè®¿é—®ä¸åŒè·¯å¾„çš„è¯·æ±‚è¿›è¡Œåå‘ä»£ç†ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("æŠŠè®¿é—® "),a("code",[t._v("http://127.0.0.1:9001/edu")]),t._v(" çš„è¯·æ±‚è½¬å‘åˆ° "),a("code",[t._v("http://127.0.0.1:8080")])]),t._v(" "),a("li",[t._v("æŠŠè®¿é—® "),a("code",[t._v("http://127.0.0.1:9001/vod")]),t._v(" çš„è¯·æ±‚è½¬å‘åˆ° "),a("code",[t._v("http://127.0.0.1:8081")])])]),t._v(" "),a("p",[t._v("è¿™ç§è¦æ€ä¹ˆé…ç½®å‘¢ï¼Œé¦–å…ˆåŒæ ·æ‰“å¼€ä¸»é…ç½®æ–‡ä»¶ï¼Œç„¶ååœ¨ http æ¨¡å—ä¸‹å¢åŠ ä¸€ä¸ª server å—ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9001")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" *.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~ /edu/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:8080")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~ /vod/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:8081")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("åå‘ä»£ç†è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æŒ‡ä»¤ï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹ï¼š")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("proxy_set_header")]),t._v("ï¼šåœ¨å°†å®¢æˆ·ç«¯è¯·æ±‚å‘é€ç»™åç«¯æœåŠ¡å™¨ä¹‹å‰ï¼Œæ›´æ”¹æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚å¤´ä¿¡æ¯ã€‚")]),t._v(" "),a("li",[a("code",[t._v("proxy_connect_timeout")]),t._v("ï¼šé…ç½®Nginxä¸åç«¯ä»£ç†æœåŠ¡å™¨å°è¯•å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´ã€‚")]),t._v(" "),a("li",[a("code",[t._v("proxy_read_timeout")]),t._v("ï¼šé…ç½®Nginxå‘åç«¯æœåŠ¡å™¨ç»„å‘å‡ºreadè¯·æ±‚åï¼Œç­‰å¾…ç›¸åº”çš„è¶…æ—¶æ—¶é—´ã€‚")]),t._v(" "),a("li",[a("code",[t._v("proxy_send_timeout")]),t._v("ï¼šé…ç½®Nginxå‘åç«¯æœåŠ¡å™¨ç»„å‘å‡ºwriteè¯·æ±‚åï¼Œç­‰å¾…ç›¸åº”çš„è¶…æ—¶æ—¶é—´ã€‚")]),t._v(" "),a("li",[a("code",[t._v("proxy_redirect")]),t._v("ï¼šç”¨äºä¿®æ”¹åç«¯æœåŠ¡å™¨è¿”å›çš„å“åº”å¤´ä¸­çš„Locationå’ŒRefreshã€‚")])]),t._v(" "),a("h2",{attrs:{id:"_8-è·¨åŸŸ-cors-é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-è·¨åŸŸ-cors-é…ç½®"}},[t._v("#")]),t._v(" 8. è·¨åŸŸ CORS é…ç½®")]),t._v(" "),a("p",[t._v("å…³äºç®€å•è¯·æ±‚ã€éç®€å•è¯·æ±‚ã€è·¨åŸŸçš„æ¦‚å¿µï¼Œå‰é¢å·²ç»ä»‹ç»è¿‡äº†ï¼Œè¿˜ä¸äº†è§£çš„å¯ä»¥çœ‹çœ‹å‰é¢çš„è®²è§£ã€‚ç°åœ¨å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ä¸€ç»Ÿå¤©ä¸‹ï¼Œç»å¸¸æœ¬åœ°èµ·äº†å‰ç«¯æœåŠ¡ï¼Œéœ€è¦è®¿é—®ä¸åŒçš„åç«¯åœ°å€ï¼Œä¸å¯é¿å…é‡åˆ°è·¨åŸŸé—®é¢˜ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96b16214cc~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200427220536208"}})]),t._v(" "),a("p",[t._v("è¦è§£å†³è·¨åŸŸé—®é¢˜ï¼Œæˆ‘ä»¬æ¥åˆ¶é€ ä¸€ä¸ªè·¨åŸŸé—®é¢˜ã€‚é¦–å…ˆå’Œå‰é¢è®¾ç½®äºŒçº§åŸŸåçš„æ–¹å¼ä¸€æ ·ï¼Œå…ˆè®¾ç½®å¥½ "),a("code",[t._v("fe.sherlocked93.club")]),t._v(" å’Œ "),a("code",[t._v("be.sherlocked93.club")]),t._v(" äºŒçº§åŸŸåï¼Œéƒ½æŒ‡å‘æœ¬äº‘æœåŠ¡å™¨åœ°å€ï¼Œè™½ç„¶å¯¹åº” IP æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åœ¨ "),a("code",[t._v("fe.sherlocked93.club")]),t._v(" åŸŸåå‘å‡ºçš„è¯·æ±‚è®¿é—® "),a("code",[t._v("be.sherlocked93.club")]),t._v(" åŸŸåçš„è¯·æ±‚è¿˜æ˜¯è·¨åŸŸäº†ï¼Œå› ä¸ºè®¿é—®çš„ host ä¸ä¸€è‡´ï¼ˆå¦‚æœä¸çŸ¥é“å•¥åŸå› å‚è§å‰é¢è·¨åŸŸçš„å†…å®¹ï¼‰ã€‚")]),t._v(" "),a("h3",{attrs:{id:"_8-1-ä½¿ç”¨åå‘ä»£ç†è§£å†³è·¨åŸŸ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-ä½¿ç”¨åå‘ä»£ç†è§£å†³è·¨åŸŸ"}},[t._v("#")]),t._v(" 8.1 ä½¿ç”¨åå‘ä»£ç†è§£å†³è·¨åŸŸ")]),t._v(" "),a("p",[t._v("åœ¨å‰ç«¯æœåŠ¡åœ°å€ä¸º "),a("code",[t._v("fe.sherlocked93.club")]),t._v(" çš„é¡µé¢è¯·æ±‚ "),a("code",[t._v("be.sherlocked93.club")]),t._v(" çš„åç«¯æœåŠ¡å¯¼è‡´çš„è·¨åŸŸï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9001")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" fe.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" be.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("è¿™æ ·å°±å°†å¯¹å‰ä¸€ä¸ªåŸŸå "),a("code",[t._v("fe.sherlocked93.club")]),t._v(" çš„è¯·æ±‚å…¨éƒ½ä»£ç†åˆ°äº† "),a("code",[t._v("be.sherlocked93.club")]),t._v("ï¼Œå‰ç«¯çš„è¯·æ±‚éƒ½è¢«æˆ‘ä»¬ç”¨æœåŠ¡å™¨ä»£ç†åˆ°äº†åç«¯åœ°å€ä¸‹ï¼Œç»•è¿‡äº†è·¨åŸŸã€‚")]),t._v(" "),a("p",[t._v("è¿™é‡Œå¯¹é™æ€æ–‡ä»¶çš„è¯·æ±‚å’Œåç«¯æœåŠ¡çš„è¯·æ±‚éƒ½ä»¥ "),a("code",[t._v("fe.sherlocked93.club")]),t._v(" å¼€å§‹ï¼Œä¸æ˜“åŒºåˆ†ï¼Œæ‰€ä»¥ä¸ºäº†å®ç°å¯¹åç«¯æœåŠ¡è¯·æ±‚çš„ç»Ÿä¸€è½¬å‘ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šçº¦å®šå¯¹åç«¯æœåŠ¡çš„è¯·æ±‚åŠ ä¸Š "),a("code",[t._v("/apis/")]),t._v(" å‰ç¼€æˆ–è€…å…¶ä»–çš„ path æ¥å’Œå¯¹é™æ€èµ„æºçš„è¯·æ±‚åŠ ä»¥åŒºåˆ†ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è¿™æ ·é…ç½®ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è¯·æ±‚è·¨åŸŸï¼Œçº¦å®šä»£ç†åç«¯æœåŠ¡è¯·æ±‚pathä»¥/apis/å¼€å¤´")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ^~/apis/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è¿™é‡Œé‡å†™äº†è¯·æ±‚ï¼Œå°†æ­£åˆ™åŒ¹é…ä¸­çš„ç¬¬ä¸€ä¸ªåˆ†ç»„çš„pathæ‹¼æ¥åˆ°çœŸæ­£çš„è¯·æ±‚åé¢ï¼Œå¹¶ç”¨breakåœæ­¢åç»­åŒ¹é…")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rewrite")]),t._v(" ^/apis/(.*)$ /"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" be.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¸¤ä¸ªåŸŸåä¹‹é—´cookieçš„ä¼ é€’ä¸å›å†™")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_cookie_domain")]),t._v(" be.sherlocked93.club fe.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("è¿™æ ·ï¼Œé™æ€èµ„æºæˆ‘ä»¬ä½¿ç”¨ "),a("code",[t._v("fe.sherlocked93.club/xx.html")]),t._v("ï¼ŒåŠ¨æ€èµ„æºæˆ‘ä»¬ä½¿ç”¨ "),a("code",[t._v("fe.sherlocked93.club/apis/getAwo")]),t._v("ï¼Œæµè§ˆå™¨é¡µé¢çœ‹èµ·æ¥ä»ç„¶è®¿é—®çš„å‰ç«¯æœåŠ¡å™¨ï¼Œç»•è¿‡äº†æµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œæ¯•ç«Ÿæˆ‘ä»¬çœ‹èµ·æ¥å¹¶æ²¡æœ‰è·¨åŸŸã€‚")]),t._v(" "),a("p",[t._v("ä¹Ÿå¯ä»¥ç»Ÿä¸€ä¸€ç‚¹ï¼Œç›´æ¥æŠŠå‰åç«¯æœåŠ¡å™¨åœ°å€ç›´æ¥éƒ½è½¬å‘åˆ°å¦ä¸€ä¸ª "),a("code",[t._v("server.sherlocked93.club")]),t._v("ï¼Œåªé€šè¿‡åœ¨åé¢æ·»åŠ çš„ path æ¥åŒºåˆ†è¯·æ±‚çš„æ˜¯é™æ€èµ„æºè¿˜æ˜¯åç«¯æœåŠ¡ï¼Œçœ‹éœ€æ±‚äº†ã€‚")]),t._v(" "),a("h3",{attrs:{id:"_8-2-é…ç½®-header-è§£å†³è·¨åŸŸ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-é…ç½®-header-è§£å†³è·¨åŸŸ"}},[t._v("#")]),t._v(" 8.2 é…ç½® header è§£å†³è·¨åŸŸ")]),t._v(" "),a("p",[t._v("å½“æµè§ˆå™¨åœ¨è®¿é—®è·¨æºçš„æœåŠ¡å™¨æ—¶ï¼Œä¹Ÿå¯ä»¥åœ¨è·¨åŸŸçš„æœåŠ¡å™¨ä¸Šç›´æ¥è®¾ç½® Nginxï¼Œä»è€Œå‰ç«¯å°±å¯ä»¥æ— æ„Ÿåœ°å¼€å‘ï¼Œä¸ç”¨æŠŠå®é™…ä¸Šè®¿é—®åç«¯çš„åœ°å€æ”¹æˆå‰ç«¯æœåŠ¡çš„åœ°å€ï¼Œè¿™æ ·å¯é€‚æ€§æ›´é«˜ã€‚")]),t._v(" "),a("p",[t._v("æ¯”å¦‚å‰ç«¯ç«™ç‚¹æ˜¯ "),a("code",[t._v("fe.sherlocked93.club")]),t._v("ï¼Œè¿™ä¸ªåœ°å€ä¸‹çš„å‰ç«¯é¡µé¢è¯·æ±‚ "),a("code",[t._v("be.sherlocked93.club")]),t._v(" ä¸‹çš„èµ„æºï¼Œæ¯”å¦‚å‰è€…çš„ "),a("code",[t._v("fe.sherlocked93.club/index.html")]),t._v(" å†…å®¹æ˜¯è¿™æ ·çš„ï¼š")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("welcome fe.sherlocked93.club!!"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("text/javascript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xmlhttp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    xmlhttp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://be.sherlocked93.club/index.html"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    xmlhttp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("æ‰“å¼€æµè§ˆå™¨è®¿é—® "),a("code",[t._v("fe.sherlocked93.club/index.html")]),t._v(" çš„ç»“æœå¦‚ä¸‹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96b99b44b7~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200428191153736"}})]),t._v(" "),a("p",[t._v("å¾ˆæ˜æ˜¾è¿™é‡Œæ˜¯è·¨åŸŸè¯·æ±‚ï¼Œåœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—® "),a("code",[t._v("http://be.sherlocked93.club/index.html")]),t._v(" æ˜¯å¯ä»¥è®¿é—®åˆ°çš„ï¼Œä½†æ˜¯åœ¨ "),a("code",[t._v("fe.sherlocked93.club")]),t._v(" çš„ html é¡µé¢è®¿é—®å°±ä¼šå‡ºç°è·¨åŸŸã€‚")]),t._v(" "),a("p",[t._v("åœ¨ "),a("code",[t._v("/etc/nginx/conf.d/")]),t._v(" æ–‡ä»¶å¤¹ä¸­æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯¹åº”äºŒçº§åŸŸå "),a("code",[t._v("be.sherlocked93.club")]),t._v(" ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/nginx/conf.d/be.sherlocked93.club.conf")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  be.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_origin")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å…¨å±€å˜é‡è·å¾—å½“å‰è¯·æ±‚originï¼Œå¸¦cookieçš„è¯·æ±‚ä¸æ”¯æŒ*")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Credentials'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'true'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¸º true å¯å¸¦ä¸Š cookie")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Methods'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET, POST, OPTIONS'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å…è®¸è¯·æ±‚æ–¹æ³•")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Headers'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_access_control_request_headers")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å…è®¸è¯·æ±‚çš„ headerï¼Œå¯ä»¥ä¸º *")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Expose-Headers'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Length,Content-Range'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_method")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'OPTIONS'")]),t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Max-Age'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1728000")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# OPTIONS è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼Œåœ¨æœ‰æ•ˆæœŸå†…ä¸ç”¨å‘å‡ºå¦ä¸€æ¡é¢„æ£€è¯·æ±‚")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain; charset=utf-8'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Length'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("204")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 200 ä¹Ÿå¯ä»¥")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("  /usr/share/nginx/html/be")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" index.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("ç„¶å "),a("code",[t._v("nginx -s reload")]),t._v(" é‡æ–°åŠ è½½é…ç½®ã€‚è¿™æ—¶å†è®¿é—® "),a("code",[t._v("fe.sherlocked93.club/index.html")]),t._v(" ç»“æœå¦‚ä¸‹ï¼Œè¯·æ±‚ä¸­å‡ºç°äº†æˆ‘ä»¬åˆšåˆšé…ç½®çš„ Headerï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96c8e70d22~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200428192028636"}})]),t._v(" "),a("p",[t._v("è§£å†³äº†è·¨åŸŸé—®é¢˜ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_9-å¼€å¯-gzip-å‹ç¼©"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-å¼€å¯-gzip-å‹ç¼©"}},[t._v("#")]),t._v(" 9. å¼€å¯ gzip å‹ç¼©")]),t._v(" "),a("p",[t._v("gzip æ˜¯ä¸€ç§å¸¸ç”¨çš„ç½‘é¡µå‹ç¼©æŠ€æœ¯ï¼Œä¼ è¾“çš„ç½‘é¡µç»è¿‡ gzip å‹ç¼©ä¹‹åå¤§å°é€šå¸¸å¯ä»¥å˜ä¸ºåŸæ¥çš„ä¸€åŠç”šè‡³æ›´å°ï¼ˆå®˜ç½‘åŸè¯ï¼‰ï¼Œæ›´å°çš„ç½‘é¡µä½“ç§¯ä¹Ÿå°±æ„å‘³ç€å¸¦å®½çš„èŠ‚çº¦å’Œä¼ è¾“é€Ÿåº¦çš„æå‡ï¼Œç‰¹åˆ«æ˜¯å¯¹äºè®¿é—®é‡å·¨å¤§å¤§å‹ç½‘ç«™æ¥è¯´ï¼Œæ¯ä¸€ä¸ªé™æ€èµ„æºä½“ç§¯çš„å‡å°ï¼Œéƒ½ä¼šå¸¦æ¥å¯è§‚çš„æµé‡ä¸å¸¦å®½çš„èŠ‚çœã€‚")]),t._v(" "),a("p",[t._v("ç™¾åº¦å¯ä»¥æ‰¾åˆ°å¾ˆå¤šæ£€æµ‹ç«™ç‚¹æ¥æŸ¥çœ‹ç›®æ ‡ç½‘é¡µæœ‰æ²¡æœ‰å¼€å¯ gzip å‹ç¼©ï¼Œåœ¨ä¸‹éšä¾¿æ‰¾äº†ä¸€ä¸ª "),a("a",{attrs:{href:"https://link.juejin.cn?target=http%3A%2F%2Ftool.chinaz.com%2FGzips%2FDefault.aspx%3Fq%3Djuejin.im",target:"_blank",rel:"noopener noreferrer"}},[t._v("<ç½‘é¡µGZIPå‹ç¼©æ£€æµ‹>"),a("OutboundLink")],1),t._v(" è¾“å…¥æ˜é‡‘ "),a("code",[t._v("juejin.im")]),t._v(" æ¥å·çª¥ä¸‹æ˜é‡‘æœ‰æ²¡æœ‰å¼€å¯ gzipã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96dc471f0b~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200427110415809"}})]),t._v(" "),a("p",[t._v("è¿™é‡Œå¯ä»¥çœ‹åˆ°æ˜é‡‘æ˜¯å¼€å¯äº† gzip çš„ï¼Œå‹ç¼©æ•ˆæœè¿˜æŒºä¸é”™ï¼Œè¾¾åˆ°äº† 52% ä¹‹å¤šï¼Œæœ¬æ¥ "),a("code",[t._v("34kb")]),t._v(" çš„ç½‘é¡µä½“ç§¯ï¼Œå‹ç¼©å®Œåªéœ€è¦ "),a("code",[t._v("16kb")]),t._v("ï¼Œå¯ä»¥æƒ³è±¡ç½‘é¡µä¼ è¾“é€Ÿåº¦æå‡äº†ä¸å°‘ã€‚")]),t._v(" "),a("h3",{attrs:{id:"_9-1-nginx-é…ç½®-gzip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-nginx-é…ç½®-gzip"}},[t._v("#")]),t._v(" 9.1 Nginx é…ç½® gzip")]),t._v(" "),a("p",[t._v("ä½¿ç”¨ gzip ä¸ä»…éœ€è¦ Nginx é…ç½®ï¼Œæµè§ˆå™¨ç«¯ä¹Ÿéœ€è¦é…åˆï¼Œéœ€è¦åœ¨è¯·æ±‚æ¶ˆæ¯å¤´ä¸­åŒ…å« "),a("code",[t._v("Accept-Encoding: gzip")]),t._v("ï¼ˆIE5 ä¹‹åæ‰€æœ‰çš„æµè§ˆå™¨éƒ½æ”¯æŒäº†ï¼Œæ˜¯ç°ä»£æµè§ˆå™¨çš„é»˜è®¤è®¾ç½®ï¼‰ã€‚ä¸€èˆ¬åœ¨è¯·æ±‚ html å’Œ css ç­‰é™æ€èµ„æºçš„æ—¶å€™ï¼Œæ”¯æŒçš„æµè§ˆå™¨åœ¨ request è¯·æ±‚é™æ€èµ„æºçš„æ—¶å€™ï¼Œä¼šåŠ ä¸Š "),a("code",[t._v("Accept-Encoding: gzip")]),t._v(" è¿™ä¸ª headerï¼Œè¡¨ç¤ºè‡ªå·±æ”¯æŒ gzip çš„å‹ç¼©æ–¹å¼ï¼ŒNginx åœ¨æ‹¿åˆ°è¿™ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœæœ‰ç›¸åº”é…ç½®ï¼Œå°±ä¼šè¿”å›ç»è¿‡ gzip å‹ç¼©è¿‡çš„æ–‡ä»¶ç»™æµè§ˆå™¨ï¼Œå¹¶åœ¨ response ç›¸åº”çš„æ—¶å€™åŠ ä¸Š "),a("code",[t._v("content-encoding: gzip")]),t._v(" æ¥å‘Šè¯‰æµè§ˆå™¨è‡ªå·±é‡‡ç”¨çš„å‹ç¼©æ–¹å¼ï¼ˆå› ä¸ºæµè§ˆå™¨åœ¨ä¼ ç»™æœåŠ¡å™¨çš„æ—¶å€™ä¸€èˆ¬è¿˜å‘Šè¯‰æœåŠ¡å™¨è‡ªå·±æ”¯æŒå¥½å‡ ç§å‹ç¼©æ–¹å¼ï¼‰ï¼Œæµè§ˆå™¨æ‹¿åˆ°å‹ç¼©çš„æ–‡ä»¶åï¼Œæ ¹æ®è‡ªå·±çš„è§£å‹æ–¹å¼è¿›è¡Œè§£æã€‚")]),t._v(" "),a("p",[t._v("å…ˆæ¥çœ‹çœ‹ Nginx æ€ä¹ˆè¿›è¡Œ gzip é…ç½®ï¼Œå’Œä¹‹å‰çš„é…ç½®ä¸€æ ·ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œè¿˜æ˜¯åœ¨ "),a("code",[t._v("/etc/nginx/conf.d/")]),t._v(" æ–‡ä»¶å¤¹ä¸­æ–°å»ºé…ç½®æ–‡ä»¶ "),a("code",[t._v("gzip.conf")]),t._v(" ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/nginx/conf.d/gzip.conf")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é»˜è®¤offï¼Œæ˜¯å¦å¼€å¯gzip")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_types")]),t._v(" text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¸Šé¢ä¸¤ä¸ªå¼€å¯åŸºæœ¬å°±èƒ½è·‘èµ·äº†ï¼Œä¸‹é¢çš„æ„¿æ„æŠ˜è…¾å°±äº†è§£ä¸€ä¸‹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_proxied")]),t._v(" any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_vary")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_comp_level")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_buffers")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8k")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# gzip_min_length 1k;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_http_version")]),t._v(" 1.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("ç¨å¾®è§£é‡Šä¸€ä¸‹ï¼š")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("gzip_types")]),t._v("ï¼šè¦é‡‡ç”¨ gzip å‹ç¼©çš„ MIME æ–‡ä»¶ç±»å‹ï¼Œå…¶ä¸­ text/html è¢«ç³»ç»Ÿå¼ºåˆ¶å¯ç”¨ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("gzip_static")]),t._v("ï¼šé»˜è®¤ offï¼Œè¯¥æ¨¡å—å¯ç”¨åï¼ŒNginx é¦–å…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨è¯·æ±‚é™æ€æ–‡ä»¶çš„ gz ç»“å°¾çš„æ–‡ä»¶ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›è¯¥ "),a("code",[t._v(".gz")]),t._v(" æ–‡ä»¶å†…å®¹ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("gzip_proxied")]),t._v("ï¼šé»˜è®¤ offï¼Œnginxåšä¸ºåå‘ä»£ç†æ—¶å¯ç”¨ï¼Œç”¨äºè®¾ç½®å¯ç”¨æˆ–ç¦ç”¨ä»ä»£ç†æœåŠ¡å™¨ä¸Šæ”¶åˆ°ç›¸åº”å†…å®¹ gzip å‹ç¼©ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("gzip_vary")]),t._v("ï¼šç”¨äºåœ¨å“åº”æ¶ˆæ¯å¤´ä¸­æ·»åŠ  "),a("code",[t._v("Varyï¼šAccept-Encoding")]),t._v("ï¼Œä½¿ä»£ç†æœåŠ¡å™¨æ ¹æ®è¯·æ±‚å¤´ä¸­çš„ "),a("code",[t._v("Accept-Encoding")]),t._v(" è¯†åˆ«æ˜¯å¦å¯ç”¨ gzip å‹ç¼©ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("gzip_comp_level")]),t._v("ï¼šgzip å‹ç¼©æ¯”ï¼Œå‹ç¼©çº§åˆ«æ˜¯ 1-9ï¼Œ1 å‹ç¼©çº§åˆ«æœ€ä½ï¼Œ9 æœ€é«˜ï¼Œçº§åˆ«è¶Šé«˜å‹ç¼©ç‡è¶Šå¤§ï¼Œå‹ç¼©æ—¶é—´è¶Šé•¿ï¼Œå»ºè®® 4-6ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("gzip_buffers")]),t._v("ï¼šè·å–å¤šå°‘å†…å­˜ç”¨äºç¼“å­˜å‹ç¼©ç»“æœï¼Œ16 8k è¡¨ç¤ºä»¥ 8k*16 ä¸ºå•ä½è·å¾—ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("gzip_min_length")]),t._v("ï¼šå…è®¸å‹ç¼©çš„é¡µé¢æœ€å°å­—èŠ‚æ•°ï¼Œé¡µé¢å­—èŠ‚æ•°ä»headerå¤´ä¸­çš„ "),a("code",[t._v("Content-Length")]),t._v(" ä¸­è¿›è¡Œè·å–ã€‚é»˜è®¤å€¼æ˜¯ 0ï¼Œä¸ç®¡é¡µé¢å¤šå¤§éƒ½å‹ç¼©ã€‚å»ºè®®è®¾ç½®æˆå¤§äº 1k çš„å­—èŠ‚æ•°ï¼Œå°äº 1k å¯èƒ½ä¼šè¶Šå‹è¶Šå¤§ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("gzip_http_version")]),t._v("ï¼šé»˜è®¤ 1.1ï¼Œå¯ç”¨ gzip æ‰€éœ€çš„ HTTP æœ€ä½ç‰ˆæœ¬ï¼›")])]),t._v(" "),a("p",[t._v("è¿™ä¸ªé…ç½®å¯ä»¥æ’å…¥åˆ° http æ¨¡å—æ•´ä¸ªæœåŠ¡å™¨çš„é…ç½®é‡Œï¼Œä¹Ÿå¯ä»¥æ’å…¥åˆ°éœ€è¦ä½¿ç”¨çš„è™šæ‹Ÿä¸»æœºçš„ "),a("code",[t._v("server")]),t._v(" æˆ–è€…ä¸‹é¢çš„ "),a("code",[t._v("location")]),t._v(" æ¨¡å—ä¸­ï¼Œå½“ç„¶åƒä¸Šé¢æˆ‘ä»¬è¿™æ ·å†™çš„è¯å°±æ˜¯è¢« include åˆ° http æ¨¡å—ä¸­äº†ã€‚")]),t._v(" "),a("p",[t._v("å…¶ä»–æ›´å…¨çš„é…ç½®ä¿¡æ¯å¯ä»¥æŸ¥çœ‹ "),a("a",{attrs:{href:"https://link.juejin.cn?target=http%3A%2F%2Fnginx.org%2Fen%2Fdocs%2Fhttp%2Fngx_http_gzip_module.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("<å®˜ç½‘æ–‡æ¡£ngx_http_gzip_module>"),a("OutboundLink")],1),t._v("ï¼Œé…ç½®å‰æ˜¯è¿™æ ·çš„ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96dd2b5019~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200427161022215"}})]),t._v(" "),a("p",[t._v("é…ç½®ä¹‹å response çš„ header é‡Œé¢å¤šäº†ä¸€ä¸ª "),a("code",[t._v("Content-Encoding: gzip")]),t._v("ï¼Œè¿”å›ä¿¡æ¯è¢«å‹ç¼©äº†ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96def4db0f~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200427164033577"}})]),t._v(" "),a("p",[t._v("æ³¨æ„äº†ï¼Œä¸€èˆ¬ gzip çš„é…ç½®å»ºè®®åŠ ä¸Š "),a("code",[t._v("gzip_min_length 1k")]),t._v("ï¼Œä¸åŠ çš„è¯ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96ee3279e8~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200427164408389"}})]),t._v(" "),a("p",[t._v("ç”±äºæ–‡ä»¶å¤ªå°ï¼Œgzip å‹ç¼©ä¹‹åå¾—åˆ°äº† -48% çš„ä½“ç§¯ä¼˜åŒ–ï¼Œå‹ç¼©ä¹‹åä½“ç§¯è¿˜æ¯”å‹ç¼©ä¹‹å‰ä½“ç§¯å¤§äº†ï¼Œæ‰€ä»¥æœ€å¥½è®¾ç½®ä½äº "),a("code",[t._v("1kb")]),t._v(" çš„æ–‡ä»¶å°±ä¸è¦ gzip å‹ç¼©äº† ğŸ¤ª")]),t._v(" "),a("h3",{attrs:{id:"_9-2-webpack-çš„-gzip-é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-webpack-çš„-gzip-é…ç½®"}},[t._v("#")]),t._v(" 9.2 Webpack çš„ gzip é…ç½®")]),t._v(" "),a("p",[t._v("å½“å‰ç«¯é¡¹ç›®ä½¿ç”¨ Webpack è¿›è¡Œæ‰“åŒ…çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥å¼€å¯ gzip å‹ç¼©ï¼š")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue-cli3 çš„ vue.config.js æ–‡ä»¶")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" CompressionWebpackPlugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'compression-webpack-plugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// gzip é…ç½®")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("configureWebpack")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("config")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”Ÿäº§ç¯å¢ƒ")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompressionWebpackPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.js$|\\.html$|\\.css")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åŒ¹é…æ–‡ä»¶å")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("threshold")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10240")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ–‡ä»¶å‹ç¼©é˜ˆå€¼ï¼Œå¯¹è¶…è¿‡10kçš„è¿›è¡Œå‹ç¼©")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("deleteOriginalAssets")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ˜¯å¦åˆ é™¤æºæ–‡ä»¶")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("ç”±æ­¤æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å¦‚ä¸‹å›¾ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e96f98708c7~tplv-t2oaga2asx-watermark.awebp",alt:"image-20200427144824829"}})]),t._v(" "),a("p",[t._v("è¿™é‡Œå¯ä»¥çœ‹åˆ°æŸäº›æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ä¸‹é¢æœ‰ä¸€ä¸ªå¯¹åº”çš„ "),a("code",[t._v(".gz")]),t._v(" ç»è¿‡ "),a("code",[t._v("gzip")]),t._v(" å‹ç¼©ä¹‹åçš„æ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºè¿™ä¸ªæ–‡ä»¶è¶…è¿‡äº† "),a("code",[t._v("10kb")]),t._v("ï¼Œæœ‰çš„æ–‡ä»¶æ²¡æœ‰è¶…è¿‡ "),a("code",[t._v("10kb")]),t._v(" å°±æ²¡æœ‰è¿›è¡Œ "),a("code",[t._v("gzip")]),t._v(" æ‰“åŒ…ï¼Œå¦‚æœä½ æœŸæœ›å‹ç¼©æ–‡ä»¶çš„ä½“ç§¯é˜ˆå€¼å°ä¸€ç‚¹ï¼Œå¯ä»¥åœ¨ "),a("code",[t._v("compression-webpack-plugin")]),t._v(" è¿™ä¸ªæ’ä»¶çš„é…ç½®é‡Œè¿›è¡Œå¯¹åº”é…ç½®ã€‚")]),t._v(" "),a("p",[t._v("é‚£ä¹ˆä¸ºå•¥è¿™é‡Œ Nginx å·²ç»æœ‰äº† gzip å‹ç¼©ï¼ŒWebpack è¿™é‡Œåˆæ•´äº†ä¸ª gzip å‘¢ï¼Œå› ä¸ºå¦‚æœå…¨éƒ½æ˜¯ä½¿ç”¨ Nginx æ¥å‹ç¼©æ–‡ä»¶ï¼Œä¼šè€—è´¹æœåŠ¡å™¨çš„è®¡ç®—èµ„æºï¼Œå¦‚æœæœåŠ¡å™¨çš„ "),a("code",[t._v("gzip_comp_level")]),t._v(" é…ç½®çš„æ¯”è¾ƒé«˜ï¼Œå°±æ›´å¢åŠ æœåŠ¡å™¨çš„å¼€é”€ï¼Œç›¸åº”å¢åŠ å®¢æˆ·ç«¯çš„è¯·æ±‚æ—¶é—´ï¼Œå¾—ä¸å¿å¤±ã€‚")]),t._v(" "),a("p",[t._v("å¦‚æœå‹ç¼©çš„åŠ¨ä½œåœ¨å‰ç«¯æ‰“åŒ…çš„æ—¶å€™å°±åšäº†ï¼ŒæŠŠæ‰“åŒ…ä¹‹åçš„é«˜å‹ç¼©ç­‰çº§æ–‡ä»¶ä½œä¸ºé™æ€èµ„æºæ”¾åœ¨æœåŠ¡å™¨ä¸Šï¼ŒNginx ä¼šä¼˜å…ˆæŸ¥æ‰¾è¿™äº›å‹ç¼©ä¹‹åçš„æ–‡ä»¶è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œç›¸å½“äºæŠŠå‹ç¼©æ–‡ä»¶çš„åŠ¨ä½œä» Nginx æå‰ç»™ Webpack æ‰“åŒ…çš„æ—¶å€™å®Œæˆï¼ŒèŠ‚çº¦äº†æœåŠ¡å™¨èµ„æºï¼Œæ‰€ä»¥ä¸€èˆ¬æ¨ä»‹åœ¨ç”Ÿäº§ç¯å¢ƒåº”ç”¨ Webpack é…ç½® gzip å‹ç¼©ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_10-é…ç½®è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-é…ç½®è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" 10. é…ç½®è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[t._v("è´Ÿè½½å‡è¡¡åœ¨ä¹‹å‰å·²ç»ä»‹ç»äº†ç›¸å…³æ¦‚å¿µäº†ï¼Œä¸»è¦æ€æƒ³å°±æ˜¯æŠŠè´Ÿè½½å‡åŒ€åˆç†åœ°åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œå®ç°å‹åŠ›åˆ†æµçš„ç›®çš„ã€‚")]),t._v(" "),a("p",[t._v("ä¸»è¦é…ç½®å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("upstream")]),t._v(" myserver")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ip_hash;  # ip_hash æ–¹å¼")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fair;   # fair æ–¹å¼")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" 127.0.0.1:8081")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è´Ÿè½½å‡è¡¡ç›®çš„æœåŠ¡åœ°å€")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" 127.0.0.1:8080")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" 127.0.0.1:8082 weight=10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# weight æ–¹å¼ï¼Œä¸å†™é»˜è®¤ä¸º 1")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n \n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://myserver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_connect_timeout")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("Nginx æä¾›äº†å¥½å‡ ç§åˆ†é…æ–¹å¼ï¼Œé»˜è®¤ä¸º"),a("strong",[t._v("è½®è¯¢")]),t._v("ï¼Œå°±æ˜¯è½®æµæ¥ã€‚æœ‰ä»¥ä¸‹å‡ ç§åˆ†é…æ–¹å¼ï¼š")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("è½®è¯¢")]),t._v("ï¼Œé»˜è®¤æ–¹å¼ï¼Œæ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡æŒ‚äº†ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("weight")]),t._v("ï¼Œæƒé‡åˆ†é…ï¼ŒæŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œæƒé‡è¶Šé«˜ï¼Œåœ¨è¢«è®¿é—®çš„æ¦‚ç‡è¶Šå¤§ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µï¼›")]),t._v(" "),a("li",[a("strong",[t._v("ip_hash")]),t._v("ï¼Œæ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® IP çš„ hash ç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³åŠ¨æ€ç½‘é¡µ session å…±äº«é—®é¢˜ã€‚è´Ÿè½½å‡è¡¡æ¯æ¬¡è¯·æ±‚éƒ½ä¼šé‡æ–°å®šä½åˆ°æœåŠ¡å™¨é›†ç¾¤ä¸­çš„æŸä¸€ä¸ªï¼Œé‚£ä¹ˆå·²ç»ç™»å½•æŸä¸€ä¸ªæœåŠ¡å™¨çš„ç”¨æˆ·å†é‡æ–°å®šä½åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå…¶ç™»å½•ä¿¡æ¯å°†ä¼šä¸¢å¤±ï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯ä¸å¦¥çš„ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("fair")]),t._v("ï¼ˆç¬¬ä¸‰æ–¹ï¼‰ï¼ŒæŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´åˆ†é…ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ï¼Œä¾èµ–ç¬¬ä¸‰æ–¹æ’ä»¶ nginx-upstream-fairï¼Œéœ€è¦å…ˆå®‰è£…ï¼›")])]),t._v(" "),a("h2",{attrs:{id:"_11-é…ç½®åŠ¨é™åˆ†ç¦»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-é…ç½®åŠ¨é™åˆ†ç¦»"}},[t._v("#")]),t._v(" 11. é…ç½®åŠ¨é™åˆ†ç¦»")]),t._v(" "),a("p",[t._v("åŠ¨é™åˆ†ç¦»åœ¨ä¹‹å‰ä¹Ÿä»‹ç»è¿‡äº†ï¼Œå°±æ˜¯æŠŠåŠ¨æ€å’Œé™æ€çš„è¯·æ±‚åˆ†å¼€ã€‚æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§ï¼Œä¸€ç§ æ˜¯çº¯ç²¹æŠŠé™æ€æ–‡ä»¶ç‹¬ç«‹æˆå•ç‹¬çš„åŸŸåï¼Œæ”¾åœ¨ç‹¬ç«‹çš„æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿæ˜¯ç›®å‰ä¸»æµæ¨å´‡çš„æ–¹æ¡ˆã€‚å¦å¤–ä¸€ç§æ–¹æ³•å°±æ˜¯åŠ¨æ€è·Ÿé™æ€æ–‡ä»¶æ··åˆåœ¨ä¸€èµ·å‘å¸ƒï¼Œ é€šè¿‡ Nginx é…ç½®æ¥åˆ†å¼€ã€‚")]),t._v(" "),a("p",[t._v("é€šè¿‡ location æŒ‡å®šä¸åŒçš„åç¼€åå®ç°ä¸åŒçš„è¯·æ±‚è½¬å‘ã€‚é€šè¿‡ expires å‚æ•°è®¾ç½®ï¼Œå¯ä»¥ä½¿æµè§ˆå™¨ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œå‡å°‘ä¸æœåŠ¡å™¨ä¹‹å‰çš„è¯·æ±‚å’Œæµé‡ã€‚å…·ä½“ expires å®šä¹‰ï¼šæ˜¯ç»™ä¸€ä¸ªèµ„æºè®¾å®šä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´æ— éœ€å»æœåŠ¡ç«¯éªŒè¯ï¼Œç›´æ¥é€šè¿‡æµè§ˆå™¨è‡ªèº«ç¡®è®¤æ˜¯å¦è¿‡æœŸå³å¯ï¼Œæ‰€ä»¥ä¸ä¼šäº§ç”Ÿé¢å¤–çš„æµé‡ã€‚æ­¤ç§æ–¹æ³•éå¸¸é€‚åˆä¸ç»å¸¸å˜åŠ¨çš„èµ„æºã€‚ï¼ˆå¦‚æœç»å¸¸æ›´æ–°çš„æ–‡ä»¶ï¼Œä¸å»ºè®®ä½¿ç”¨ expires æ¥ç¼“å­˜ï¼‰ï¼Œæˆ‘è¿™é‡Œè®¾ç½® 3dï¼Œè¡¨ç¤ºåœ¨è¿™ 3 å¤©ä¹‹å†…è®¿é—®è¿™ä¸ªURLï¼Œå‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œæ¯”å¯¹æœåŠ¡å™¨è¯¥æ–‡ä»¶æœ€åæ›´æ–°æ—¶é—´æ²¡æœ‰å˜åŒ–ã€‚åˆ™ä¸ä¼šä»æœåŠ¡å™¨æŠ“å–ï¼Œè¿”å›çŠ¶æ€ç  304ï¼Œå¦‚æœæœ‰ä¿®æ”¹ï¼Œåˆ™ç›´æ¥ä»æœåŠ¡å™¨é‡æ–°ä¸‹è½½ï¼Œè¿”å›çŠ¶æ€ç  200ã€‚")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /www/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" /data/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" index.html index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /image/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" /data/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("autoindex")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h2",{attrs:{id:"_12-é…ç½®é«˜å¯ç”¨é›†ç¾¤-åŒæœºçƒ­å¤‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-é…ç½®é«˜å¯ç”¨é›†ç¾¤-åŒæœºçƒ­å¤‡"}},[t._v("#")]),t._v(" 12. é…ç½®é«˜å¯ç”¨é›†ç¾¤ï¼ˆåŒæœºçƒ­å¤‡ï¼‰")]),t._v(" "),a("p",[t._v("å½“ä¸» Nginx æœåŠ¡å™¨å®•æœºä¹‹åï¼Œåˆ‡æ¢åˆ°å¤‡ä»½ Nginx æœåŠ¡å™¨")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/SHERlocked93/pic@env/uPic/2020-03-13-%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87%20%281%29.png",alt:"2020-03-13-åŒæœºçƒ­å¤‡"}})]),t._v(" "),a("p",[t._v("é¦–å…ˆå®‰è£… keepalivedï¼Œ")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" keepalived -y\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("ç„¶åç¼–è¾‘ "),a("code",[t._v("/etc/keepalived/keepalived.conf")]),t._v(" é…ç½®æ–‡ä»¶ï¼Œå¹¶åœ¨é…ç½®æ–‡ä»¶ä¸­å¢åŠ  "),a("code",[t._v("vrrp_script")]),t._v(" å®šä¹‰ä¸€ä¸ªå¤–å›´æ£€æµ‹æœºåˆ¶ï¼Œå¹¶åœ¨ "),a("code",[t._v("vrrp_instance")]),t._v(" ä¸­é€šè¿‡å®šä¹‰ "),a("code",[t._v("track_script")]),t._v(" æ¥è¿½è¸ªè„šæœ¬æ‰§è¡Œè¿‡ç¨‹ï¼Œå®ç°èŠ‚ç‚¹è½¬ç§»ï¼š")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("global_defs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   notification_email "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        acassen@firewall.loc\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   notification_email_from Alexandre@firewall.loc\n   smtp_server "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v("."),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v("\n   smtp_connect_timeout "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸Šé¢éƒ½æ˜¯é‚®ä»¶é…ç½®ï¼Œæ²¡åµç”¨")]),t._v("\n   router_id LVS_DEVEL     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰æœåŠ¡å™¨åå­—ï¼Œç”¨hostnameå‘½ä»¤æ¥æŸ¥çœ‹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nvrrp_script chk_maintainace "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ£€æµ‹æœºåˆ¶çš„è„šæœ¬åç§°ä¸ºchk_maintainace")]),t._v("\n    script "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[[ -e/etc/keepalived/down ]] && exit 1 || exit 0"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯ä»¥æ˜¯è„šæœ¬è·¯å¾„æˆ–è„šæœ¬å‘½ä»¤")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// script "/etc/keepalived/nginx_check.sh"    // æ¯”å¦‚è¿™æ ·çš„è„šæœ¬è·¯å¾„')]),t._v("\n    interval "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¯éš”2ç§’æ£€æµ‹ä¸€æ¬¡")]),t._v("\n    weight "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("-20")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“è„šæœ¬æ‰§è¡Œæˆç«‹ï¼Œé‚£ä¹ˆæŠŠå½“å‰æœåŠ¡å™¨ä¼˜å…ˆçº§æ”¹ä¸º-20")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nvrrp_instanceVI_1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¯ä¸€ä¸ªvrrp_instanceå°±æ˜¯å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿè·¯ç”±å™¨")]),t._v("\n    state MASTER      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸»æœºä¸ºMASTERï¼Œå¤‡ç”¨æœºä¸ºBACKUP")]),t._v("\n    interface eth0    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç½‘å¡åå­—ï¼Œå¯ä»¥ä»ifconfigä¸­æŸ¥æ‰¾")]),t._v("\n    virtual_router_id "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("51")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è™šæ‹Ÿè·¯ç”±çš„idå·ï¼Œä¸€èˆ¬å°äº255ï¼Œä¸»å¤‡æœºidéœ€è¦ä¸€æ ·")]),t._v("\n    priority "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¼˜å…ˆçº§ï¼Œmasterçš„ä¼˜å…ˆçº§æ¯”backupçš„å¤§")]),t._v("\n    advert_int "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é»˜è®¤å¿ƒè·³é—´éš”")]),t._v("\n    authentication "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¤è¯æœºåˆ¶")]),t._v("\n        auth_type PASS\n        auth_pass "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1111")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯†ç ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    virtual_ipaddress "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è™šæ‹Ÿåœ°å€vip")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.16")]),t._v("."),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.8")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("å…¶ä¸­æ£€æµ‹è„šæœ¬ "),a("code",[t._v("nginx_check.sh")]),t._v("ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªï¼š")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("A")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -C nginx --no-header "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wc")]),t._v(" -l"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$A")]),t._v(" -eq "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    /usr/sbin/nginx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å°è¯•é‡æ–°å¯åŠ¨nginx")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç¡çœ 2ç§’")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -C nginx --no-header "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wc")]),t._v(" -l"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v(" -eq "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("killall")]),t._v(" keepalived "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¯åŠ¨å¤±è´¥ï¼Œå°†keepalivedæœåŠ¡æ€æ­»ã€‚å°†vipæ¼‚ç§»åˆ°å…¶å®ƒå¤‡ä»½èŠ‚ç‚¹")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("å¤åˆ¶ä¸€ä»½åˆ°å¤‡ä»½æœåŠ¡å™¨ï¼Œå¤‡ä»½ Nginx çš„é…ç½®è¦å°† "),a("code",[t._v("state")]),t._v(" åæ”¹ä¸º "),a("code",[t._v("BACKUP")]),t._v("ï¼Œ"),a("code",[t._v("priority")]),t._v(" æ”¹ä¸ºæ¯”ä¸»æœºå°ã€‚")]),t._v(" "),a("p",[t._v("è®¾ç½®å®Œæ¯•åå„è‡ª "),a("code",[t._v("service keepalived start")]),t._v(" å¯åŠ¨ï¼Œç»è¿‡è®¿é—®æˆåŠŸä¹‹åï¼Œå¯ä»¥æŠŠ Master æœºçš„ keepalived åœæ‰ï¼Œæ­¤æ—¶ Master æœºå°±ä¸å†æ˜¯ä¸»æœºäº† "),a("code",[t._v("service keepalived stop")]),t._v("ï¼Œçœ‹è®¿é—®è™šæ‹Ÿ IP æ—¶æ˜¯å¦èƒ½å¤Ÿè‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡æœº "),a("code",[t._v("ip addr")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("å†æ¬¡å¯åŠ¨ Master çš„ keepalivedï¼Œæ­¤æ—¶ vip åˆå˜åˆ°äº†ä¸»æœºä¸Šã€‚")]),t._v(" "),a("h2",{attrs:{id:"_13-é€‚é…-pc-æˆ–ç§»åŠ¨è®¾å¤‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_13-é€‚é…-pc-æˆ–ç§»åŠ¨è®¾å¤‡"}},[t._v("#")]),t._v(" 13. é€‚é… PC æˆ–ç§»åŠ¨è®¾å¤‡")]),t._v(" "),a("p",[t._v("æ ¹æ®ç”¨æˆ·è®¾å¤‡ä¸åŒè¿”å›ä¸åŒæ ·å¼çš„ç«™ç‚¹ï¼Œä»¥å‰ç»å¸¸ä½¿ç”¨çš„æ˜¯çº¯å‰ç«¯çš„è‡ªé€‚åº”å¸ƒå±€ï¼Œä½†æ— è®ºæ˜¯å¤æ‚æ€§å’Œæ˜“ç”¨æ€§ä¸Šé¢è¿˜æ˜¯ä¸å¦‚åˆ†å¼€ç¼–å†™çš„å¥½ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„æ·˜å®ã€äº¬ä¸œ......è¿™äº›å¤§å‹ç½‘ç«™å°±éƒ½æ²¡æœ‰é‡‡ç”¨è‡ªé€‚åº”ï¼Œè€Œæ˜¯ç”¨åˆ†å¼€åˆ¶ä½œçš„æ–¹å¼ï¼Œæ ¹æ®ç”¨æˆ·è¯·æ±‚çš„ "),a("code",[t._v("user-agent")]),t._v(" æ¥åˆ¤æ–­æ˜¯è¿”å› PC è¿˜æ˜¯ H5 ç«™ç‚¹ã€‚")]),t._v(" "),a("p",[t._v("é¦–å…ˆåœ¨ "),a("code",[t._v("/usr/share/nginx/html")]),t._v(" æ–‡ä»¶å¤¹ä¸‹ "),a("code",[t._v("mkdir")]),t._v(" åˆ†åˆ«æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ "),a("code",[t._v("PC")]),t._v(" å’Œ "),a("code",[t._v("mobile")]),t._v("ï¼Œ"),a("code",[t._v("vim")]),t._v(" ç¼–è¾‘ä¸¤ä¸ª "),a("code",[t._v("index.html")]),t._v(" éšä¾¿å†™ç‚¹å†…å®¹ã€‚")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /usr/share/nginx/HTML.md\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" pc mobile\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" pc\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" index.HTML.md   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# éšä¾¿å†™ç‚¹æ¯”å¦‚ hello pc!")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/mobile\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" index.HTML.md   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# éšä¾¿å†™ç‚¹æ¯”å¦‚ hello mobile!")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("ç„¶åå’Œè®¾ç½®äºŒçº§åŸŸåè™šæ‹Ÿä¸»æœºæ—¶å€™ä¸€æ ·ï¼Œå» "),a("code",[t._v("/etc/nginx/conf.d")]),t._v(" æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ "),a("code",[t._v("fe.sherlocked93.club.conf")]),t._v(" ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/nginx/conf.d/fe.sherlocked93.club.conf")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" fe.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("  /usr/share/nginx/html/pc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_user_agent")]),t._v(" ~* "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(Android|webOS|iPhone|iPod|BlackBerry)'")]),t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" /usr/share/nginx/html/mobile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" index.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("é…ç½®åŸºæœ¬æ²¡ä»€ä¹ˆä¸ä¸€æ ·çš„ï¼Œä¸»è¦å¤šäº†ä¸€ä¸ª "),a("code",[t._v("if")]),t._v(" è¯­å¥ï¼Œç„¶åä½¿ç”¨ "),a("code",[t._v("$http_user_agent")]),t._v(" å…¨å±€å˜é‡æ¥åˆ¤æ–­ç”¨æˆ·è¯·æ±‚çš„ "),a("code",[t._v("user-agent")]),t._v("ï¼ŒæŒ‡å‘ä¸åŒçš„ root è·¯å¾„ï¼Œè¿”å›å¯¹åº”ç«™ç‚¹ã€‚")]),t._v(" "),a("p",[t._v("åœ¨æµè§ˆå™¨è®¿é—®è¿™ä¸ªç«™ç‚¹ï¼Œç„¶å F12 ä¸­æ¨¡æ‹Ÿä½¿ç”¨æ‰‹æœºè®¿é—®ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/29/171c4e97062c5124~tplv-t2oaga2asx-watermark.awebp",alt:"62haogU3DtwMRiZ"}})]),t._v(" "),a("p",[t._v("å¯ä»¥çœ‹åˆ°åœ¨æ¨¡æ‹Ÿä½¿ç”¨ç§»åŠ¨ç«¯è®¿é—®çš„æ—¶å€™ï¼ŒNginx è¿”å›çš„ç«™ç‚¹å˜æˆäº†ç§»åŠ¨ç«¯å¯¹åº”çš„ html äº†ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_14-é…ç½®-https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_14-é…ç½®-https"}},[t._v("#")]),t._v(" 14. é…ç½® HTTPS")]),t._v(" "),a("p",[t._v("å…·ä½“é…ç½®è¿‡ç¨‹ç½‘ä¸ŠæŒºå¤šçš„äº†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä½ è´­ä¹°çš„æŸæŸäº‘ï¼Œä¸€èˆ¬éƒ½ä¼šæœ‰"),a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fcloud.tencent.com%2Fdocument%2Fproduct%2F400%2F6814",target:"_blank",rel:"noopener noreferrer"}},[t._v("å…è´¹ç”³è¯·"),a("OutboundLink")],1),t._v("çš„æœåŠ¡å™¨è¯ä¹¦ï¼Œå®‰è£…ç›´æ¥çœ‹æ‰€åœ¨äº‘çš„æ“ä½œæŒ‡å—å³å¯ã€‚")]),t._v(" "),a("p",[t._v("æˆ‘è´­ä¹°çš„è…¾è®¯äº‘æä¾›çš„äºšæ´²è¯šä¿¡æœºæ„é¢å‘çš„å…è´¹è¯ä¹¦åªèƒ½ä¸€ä¸ªåŸŸåä½¿ç”¨ï¼ŒäºŒçº§åŸŸåä»€ä¹ˆçš„éœ€è¦å¦å¤–ç”³è¯·ï¼Œä½†æ˜¯ç”³è¯·å®¡æ‰¹æ¯”è¾ƒå¿«ï¼Œä¸€èˆ¬å‡ åˆ†é’Ÿå°±èƒ½æˆåŠŸï¼Œç„¶åä¸‹è½½è¯ä¹¦çš„å‹ç¼©æ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸ª nginx æ–‡ä»¶å¤¹ï¼ŒæŠŠ "),a("code",[t._v("xxx.crt")]),t._v(" å’Œ "),a("code",[t._v("xxx.key")]),t._v(" æ–‡ä»¶æ‹·è´åˆ°æœåŠ¡å™¨ç›®å½•ï¼Œå†é…ç½®ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v(" ssl http2 default_server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# SSL è®¿é—®ç«¯å£å·ä¸º 443")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¡«å†™ç»‘å®šè¯ä¹¦çš„åŸŸå")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate")]),t._v(" /etc/nginx/https/1_sherlocked93.club_bundle.crt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è¯ä¹¦æ–‡ä»¶åœ°å€")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate_key")]),t._v(" /etc/nginx/https/2_sherlocked93.club.key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç§é’¥æ–‡ä»¶åœ°å€")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_session_timeout")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10m")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_protocols")]),t._v(" TLSv1 TLSv1.1 TLSv1.2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#è¯·æŒ‰ç…§ä»¥ä¸‹åè®®é…ç½®")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_ciphers")]),t._v(" ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_prefer_server_ciphers")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("         /usr/share/nginx/html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("        index.html index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("p",[t._v("å†™å®Œ "),a("code",[t._v("nginx -t -q")]),t._v(" æ ¡éªŒä¸€ä¸‹ï¼Œæ²¡é—®é¢˜å°± "),a("code",[t._v("nginx -s reload")]),t._v("ï¼Œç°åœ¨å»è®¿é—® "),a("code",[t._v("https://sherlocked93.club/")]),t._v(" å°±èƒ½è®¿é—® HTTPS ç‰ˆçš„ç½‘ç«™äº†ã€‚")]),t._v(" "),a("p",[t._v("ä¸€èˆ¬è¿˜å¯ä»¥åŠ ä¸Šå‡ ä¸ªå¢å¼ºå®‰å…¨æ€§çš„å‘½ä»¤ï¼š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" X-Frame-Options DENY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å‡å°‘ç‚¹å‡»åŠ«æŒ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" X-Content-Type-Options nosniff")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç¦æ­¢æœåŠ¡å™¨è‡ªåŠ¨è§£æèµ„æºç±»å‹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" X-Xss-Protection "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é˜²XSSæ”»å‡»")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h2",{attrs:{id:"_15-ä¸€äº›å¸¸ç”¨æŠ€å·§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-ä¸€äº›å¸¸ç”¨æŠ€å·§"}},[t._v("#")]),t._v(" 15. ä¸€äº›å¸¸ç”¨æŠ€å·§")]),t._v(" "),a("h3",{attrs:{id:"_15-1-é™æ€æœåŠ¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-1-é™æ€æœåŠ¡"}},[t._v("#")]),t._v(" 15.1 é™æ€æœåŠ¡")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  static.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("charset")]),t._v(" utf-8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é˜²æ­¢ä¸­æ–‡æ–‡ä»¶åä¹±ç ")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /download")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("alias")]),t._v("\t          /usr/share/nginx/html/static")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é™æ€èµ„æºç›®å½•")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("autoindex")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¼€å¯é™æ€èµ„æºåˆ—ç›®å½•")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("autoindex_exact_size")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("off")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# on(é»˜è®¤)æ˜¾ç¤ºæ–‡ä»¶çš„ç¡®åˆ‡å¤§å°ï¼Œå•ä½æ˜¯byteï¼›offæ˜¾ç¤ºæ–‡ä»¶å¤§æ¦‚å¤§å°ï¼Œå•ä½KBã€MBã€GB")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("autoindex_localtime")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("off")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# off(é»˜è®¤)æ—¶æ˜¾ç¤ºçš„æ–‡ä»¶æ—¶é—´ä¸ºGMTæ—¶é—´ï¼›onæ˜¾ç¤ºçš„æ–‡ä»¶æ—¶é—´ä¸ºæœåŠ¡å™¨æ—¶é—´")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h3",{attrs:{id:"_15-2-å›¾ç‰‡é˜²ç›—é“¾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-2-å›¾ç‰‡é˜²ç›—é“¾"}},[t._v("#")]),t._v(" 15.2 å›¾ç‰‡é˜²ç›—é“¾")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("        \n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  *.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å›¾ç‰‡é˜²ç›—é“¾")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~* \\.(gif|jpg|jpeg|png|bmp|swf)$")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("valid_referers")]),t._v(" none blocked server_names ~\\.google\\. ~\\.baidu\\. *.qq.com")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åªå…è®¸æœ¬æœº IP å¤–é“¾å¼•ç”¨ï¼Œæ„Ÿè°¢ @æœ¨æ³•ä¼  çš„æé†’ï¼Œå°†ç™¾åº¦å’Œè°·æ­Œä¹ŸåŠ å…¥ç™½åå•")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$invalid_referer")]),t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h3",{attrs:{id:"_15-3-è¯·æ±‚è¿‡æ»¤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-3-è¯·æ±‚è¿‡æ»¤"}},[t._v("#")]),t._v(" 15.3 è¯·æ±‚è¿‡æ»¤")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# éæŒ‡å®šè¯·æ±‚å…¨è¿”å› 403")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ( "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_method")]),t._v(" !~ ^(GET|POST|HEAD)$ )")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# IPè®¿é—®é™åˆ¶ï¼ˆåªå…è®¸IPæ˜¯ 192.168.0.2 æœºå™¨è®¿é—®ï¼‰")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("allow")]),t._v(" 192.168.0.2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("deny")]),t._v(" all")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("   html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("  index.html index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h3",{attrs:{id:"_15-4-é…ç½®å›¾ç‰‡ã€å­—ä½“ç­‰é™æ€æ–‡ä»¶ç¼“å­˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-4-é…ç½®å›¾ç‰‡ã€å­—ä½“ç­‰é™æ€æ–‡ä»¶ç¼“å­˜"}},[t._v("#")]),t._v(" 15.4 é…ç½®å›¾ç‰‡ã€å­—ä½“ç­‰é™æ€æ–‡ä»¶ç¼“å­˜")]),t._v(" "),a("p",[t._v("ç”±äºå›¾ç‰‡ã€å­—ä½“ã€éŸ³é¢‘ã€è§†é¢‘ç­‰é™æ€æ–‡ä»¶åœ¨æ‰“åŒ…çš„æ—¶å€™é€šå¸¸ä¼šå¢åŠ äº† hashï¼Œæ‰€ä»¥ç¼“å­˜å¯ä»¥è®¾ç½®çš„é•¿ä¸€ç‚¹ï¼Œå…ˆè®¾ç½®å¼ºåˆ¶ç¼“å­˜ï¼Œå†è®¾ç½®åå•†ç¼“å­˜ï¼›å¦‚æœå­˜åœ¨æ²¡æœ‰ hash å€¼çš„é™æ€æ–‡ä»¶ï¼Œå»ºè®®ä¸è®¾ç½®å¼ºåˆ¶ç¼“å­˜ï¼Œä»…é€šè¿‡åå•†ç¼“å­˜åˆ¤æ–­æ˜¯å¦éœ€è¦ä½¿ç”¨ç¼“å­˜ã€‚")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å›¾ç‰‡ç¼“å­˜æ—¶é—´è®¾ç½®")]),t._v("\nlocation ~ .*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("css"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("jpg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("png"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("swf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("woff"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("woff2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("eot"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("svg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ttf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("otf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("mp3"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("m4a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("aac"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("txt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\texpires 10d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¦‚æœä¸å¸Œæœ›ç¼“å­˜")]),t._v("\nexpires -1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h3",{attrs:{id:"_15-5-å•é¡µé¢é¡¹ç›®-history-è·¯ç”±é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-5-å•é¡µé¢é¡¹ç›®-history-è·¯ç”±é…ç½®"}},[t._v("#")]),t._v(" 15.5 å•é¡µé¢é¡¹ç›® history è·¯ç”±é…ç½®")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  fe.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("       /usr/share/nginx/html/dist")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vue æ‰“åŒ…åçš„æ–‡ä»¶å¤¹")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("      index.html index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html @rewrites")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    \n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("expires")]),t._v(" -1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é¦–é¡µä¸€èˆ¬æ²¡æœ‰å¼ºåˆ¶ç¼“å­˜")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" Cache-Control no-cache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ¥å£è½¬å‘ï¼Œå¦‚æœéœ€è¦çš„è¯")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#location ~ ^/api {")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  proxy_pass http://be.sherlocked93.club;")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#}")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" @rewrites")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rewrite")]),t._v(" ^(.+)$ /index.html break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h3",{attrs:{id:"_15-6-http-è¯·æ±‚è½¬å‘åˆ°-https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-6-http-è¯·æ±‚è½¬å‘åˆ°-https"}},[t._v("#")]),t._v(" 15.6 HTTP è¯·æ±‚è½¬å‘åˆ° HTTPS")]),t._v(" "),a("p",[t._v("é…ç½®å®Œ HTTPS åï¼Œæµè§ˆå™¨è¿˜æ˜¯å¯ä»¥è®¿é—® HTTP çš„åœ°å€ "),a("code",[t._v("http://sherlocked93.club/")]),t._v(" çš„ï¼Œå¯ä»¥åšä¸€ä¸ª 301 è·³è½¬ï¼ŒæŠŠå¯¹åº”åŸŸåçš„ HTTP è¯·æ±‚é‡å®šå‘åˆ° HTTPS ä¸Š")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" www.sherlocked93.club")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å•åŸŸåé‡å®šå‘")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'www.sherlocked93.club'")]),t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" https://www.sherlocked93.club"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å…¨å±€é https åè®®æ—¶é‡å®šå‘")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$scheme")]),t._v(" != "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https'")]),t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" https://"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$server_name")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æˆ–è€…å…¨éƒ¨é‡å®šå‘")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" https://"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$server_name")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä»¥ä¸Šé…ç½®é€‰æ‹©è‡ªå·±éœ€è¦çš„å³å¯ï¼Œä¸ç”¨å…¨éƒ¨åŠ ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h3",{attrs:{id:"_15-7-æ³›åŸŸåè·¯å¾„åˆ†ç¦»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-7-æ³›åŸŸåè·¯å¾„åˆ†ç¦»"}},[t._v("#")]),t._v(" 15.7 æ³›åŸŸåè·¯å¾„åˆ†ç¦»")]),t._v(" "),a("p",[t._v("è¿™æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„æŠ€èƒ½ï¼Œç»å¸¸æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½éœ€è¦é…ç½®ä¸€äº›äºŒçº§æˆ–è€…ä¸‰çº§åŸŸåï¼Œå¸Œæœ›é€šè¿‡ Nginx è‡ªåŠ¨æŒ‡å‘å¯¹åº”ç›®å½•ï¼Œæ¯”å¦‚ï¼š")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("test1.doc.sherlocked93.club")]),t._v(" è‡ªåŠ¨æŒ‡å‘ "),a("code",[t._v("/usr/share/nginx/html/doc/test1")]),t._v(" æœåŠ¡å™¨åœ°å€ï¼›")]),t._v(" "),a("li",[a("code",[t._v("test2.doc.sherlocked93.club")]),t._v(" è‡ªåŠ¨æŒ‡å‘ "),a("code",[t._v("/usr/share/nginx/html/doc/test2")]),t._v(" æœåŠ¡å™¨åœ°å€ï¼›")])]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  ~^([\\w-]+)\\.doc\\.sherlocked93\\.club$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" /usr/share/nginx/html/doc/"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h3",{attrs:{id:"_15-8-æ³›åŸŸåè½¬å‘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-8-æ³›åŸŸåè½¬å‘"}},[t._v("#")]),t._v(" 15.8 æ³›åŸŸåè½¬å‘")]),t._v(" "),a("p",[t._v("å’Œä¹‹å‰çš„åŠŸèƒ½ç±»ä¼¼ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›æŠŠäºŒçº§æˆ–è€…ä¸‰çº§åŸŸåé“¾æ¥é‡å†™åˆ°æˆ‘ä»¬å¸Œæœ›çš„è·¯å¾„ï¼Œè®©åç«¯å°±å¯ä»¥æ ¹æ®è·¯ç”±è§£æä¸åŒçš„è§„åˆ™ï¼š")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("test1.serv.sherlocked93.club/api?name=a")]),t._v(" è‡ªåŠ¨è½¬å‘åˆ° "),a("code",[t._v("127.0.0.1:8080/test1/api?name=a")]),t._v("ï¼›")]),t._v(" "),a("li",[a("code",[t._v("test2.serv.sherlocked93.club/api?name=a")]),t._v(" è‡ªåŠ¨è½¬å‘åˆ° "),a("code",[t._v("127.0.0.1:8080/test2/api?name=a")]),t._v(" ï¼›")])]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" ~^([\\w-]+)\\.serv\\.sherlocked93\\.club$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("        X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("        X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("        Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("        X-NginX-Proxy true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v("              http://127.0.0.1:8080/"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nå¤åˆ¶ä»£ç \n")])])]),a("h2",{attrs:{id:"_16-æœ€ä½³å®è·µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_16-æœ€ä½³å®è·µ"}},[t._v("#")]),t._v(" 16. æœ€ä½³å®è·µ")]),t._v(" "),a("ol",[a("li",[t._v("ä¸ºäº†ä½¿ Nginx é…ç½®æ›´æ˜“äºç»´æŠ¤ï¼Œå»ºè®®ä¸ºæ¯ä¸ªæœåŠ¡åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„é…ç½®æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨ "),a("code",[t._v("/etc/nginx/conf.d")]),t._v(" ç›®å½•ï¼Œæ ¹æ®éœ€æ±‚å¯ä»¥åˆ›å»ºä»»æ„å¤šä¸ªç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ã€‚")]),t._v(" "),a("li",[t._v("ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ï¼Œå»ºè®®éµå¾ªä»¥ä¸‹å‘½åçº¦å®š "),a("code",[t._v("<æœåŠ¡>.conf")]),t._v("ï¼Œæ¯”å¦‚åŸŸåæ˜¯ "),a("code",[t._v("sherlocked93.club")]),t._v("ï¼Œé‚£ä¹ˆä½ çš„é…ç½®æ–‡ä»¶çš„åº”è¯¥æ˜¯è¿™æ ·çš„ "),a("code",[t._v("/etc/nginx/conf.d/sherlocked93.club.conf")]),t._v("ï¼Œå¦‚æœéƒ¨ç½²å¤šä¸ªæœåŠ¡ï¼Œä¹Ÿå¯ä»¥åœ¨æ–‡ä»¶åä¸­åŠ ä¸Š Nginx è½¬å‘çš„ç«¯å£å·ï¼Œæ¯”å¦‚ "),a("code",[t._v("sherlocked93.club.8080.conf")]),t._v("ï¼Œå¦‚æœæ˜¯äºŒçº§åŸŸåï¼Œå»ºè®®ä¹Ÿéƒ½åŠ ä¸Š "),a("code",[t._v("fe.sherlocked93.club.conf")]),t._v("ã€‚")]),t._v(" "),a("li",[t._v("å¸¸ç”¨çš„ã€å¤ç”¨é¢‘ç‡æ¯”è¾ƒé«˜çš„é…ç½®å¯ä»¥æ”¾åˆ° "),a("code",[t._v("/etc/nginx/snippets")]),t._v(" æ–‡ä»¶å¤¹ï¼Œåœ¨ Nginx çš„é…ç½®æ–‡ä»¶ä¸­éœ€è¦ç”¨åˆ°çš„ä½ç½® include è¿›å»ï¼Œä»¥åŠŸèƒ½æ¥å‘½åï¼Œå¹¶åœ¨æ¯ä¸ª snippet é…ç½®æ–‡ä»¶çš„å¼€å¤´æ³¨é‡Šæ ‡æ˜ä¸»è¦åŠŸèƒ½å’Œå¼•å…¥ä½ç½®ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚æ¯”å¦‚ä¹‹å‰çš„ "),a("code",[t._v("gzip")]),t._v("ã€"),a("code",[t._v("cors")]),t._v(" ç­‰å¸¸ç”¨é…ç½®ï¼Œæˆ‘éƒ½è®¾ç½®äº† snippetã€‚")]),t._v(" "),a("li",[t._v("Nginx æ—¥å¿—ç›¸å…³ç›®å½•ï¼Œå†…ä»¥ "),a("code",[t._v("åŸŸå.type.log")]),t._v(" å‘½åï¼ˆæ¯”å¦‚ "),a("code",[t._v("be.sherlocked93.club.access.log")]),t._v(" å’Œ "),a("code",[t._v("be.sherlocked93.club.error.log")]),t._v(" ï¼‰ä½äº "),a("code",[t._v("/var/log/nginx/")]),t._v(" ç›®å½•ä¸­ï¼Œä¸ºæ¯ä¸ªç‹¬ç«‹çš„æœåŠ¡é…ç½®ä¸åŒçš„è®¿é—®æƒé™å’Œé”™è¯¯æ—¥å¿—æ–‡ä»¶ï¼Œè¿™æ ·æŸ¥æ‰¾é”™è¯¯æ—¶ï¼Œä¼šæ›´åŠ æ–¹ä¾¿å¿«æ·ã€‚")])]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("æ„Ÿè°¢ @æœ¨æ³•ä¼  çš„æé†’ï¼ŒNginx è®¾ç½®é˜²ç›—é“¾çš„æ—¶å€™ï¼Œå¯ä»¥å°†ç™¾åº¦å’Œ google è®¾ç½®ä¸ºç™½åå•ï¼Œåˆ©äº SEO")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("ç½‘ä¸Šçš„å¸–å­å¤§å¤šæ·±æµ…ä¸ä¸€ï¼Œç”šè‡³æœ‰äº›å‰åçŸ›ç›¾ï¼Œåœ¨ä¸‹çš„æ–‡ç« éƒ½æ˜¯å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ€»ç»“ï¼Œå¦‚æœå‘ç°é”™è¯¯ï¼Œæ¬¢è¿ç•™è¨€æŒ‡å‡º~")]),t._v(" "),a("blockquote",[a("p",[t._v("å‚è€ƒæ–‡æ¡£ï¼š")]),t._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fwww.nginx.cn%2Fdoc%2F",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginxä¸­æ–‡æ–‡æ¡£"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2Fliang-io%2Fp%2F9340335.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginxå®‰è£…ï¼Œç›®å½•ç»“æ„ä¸é…ç½®æ–‡ä»¶è¯¦è§£"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fxyang81%2Farticle%2Fdetails%2F52554398",target:"_blank",rel:"noopener noreferrer"}},[t._v("Keepalivedå®‰è£…ä¸é…ç½®"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fxyang81%2Farticle%2Fdetails%2F52556886",target:"_blank",rel:"noopener noreferrer"}},[t._v("Keepalived+Nginxå®ç°é«˜å¯ç”¨"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.cn/post/6844903684967825421#comment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginxä¸å‰ç«¯å¼€å‘"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=http%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2016%2F04%2Fcors.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("è·¨åŸŸèµ„æºå…±äº« CORS è¯¦è§£ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=http%3A%2F%2Fwww.conardli.top%2Fblog%2Farticle%2F%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%2F%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E8%80%85%E5%BF%85%E5%A4%87%E7%9A%84nginx%E7%9F%A5%E8%AF%86.html%23nginx%E5%9C%A8%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8",target:"_blank",rel:"noopener noreferrer"}},[t._v("å‰ç«¯å¼€å‘è€…å¿…å¤‡çš„nginxçŸ¥è¯†"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fenvon123%2Farticle%2Fdetails%2F83270277",target:"_blank",rel:"noopener noreferrer"}},[t._v("æˆ‘ä¹Ÿè¯´è¯´Nginxè§£å†³å‰ç«¯è·¨åŸŸé—®é¢˜ï¼Œæ­£ç¡®çš„Nginxè·¨åŸŸé…ç½®"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fwww.holidaypenguin.com%2Fblob%2F2019-02-18-vue-router-history-mode-nginx-configuration-and-configuration-of-static-resource-cache%2F",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-router historyæ¨¡å¼nginxé…ç½®å¹¶é…ç½®é™æ€èµ„æºç¼“å­˜ | HolidayPenguin"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fblog.xinac.cn%2Farchives%2Fnginx%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E5%8F%82%E8%80%83%E5%A4%A7%E5%85%A8",target:"_blank",rel:"noopener noreferrer"}},[t._v("nginxé‡å®šå‘ï¼Œå…¨å±€httpsï¼ŒSSLé…ç½®ï¼Œåä»£é…ç½®å‚è€ƒ"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fxuexb.github.io%2Flearn-nginx%2F",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx å…¥é—¨æ•™ç¨‹"),a("OutboundLink")],1)])])])])}),[],!1,null,null,null);s.default=n.exports}}]);